### 1.èƒŒæ™¯æ„ä¹‰

### ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€åŸå¸‚åŒ–è¿›ç¨‹çš„åŠ å¿«å’Œç”Ÿæ´»æ°´å¹³çš„æé«˜ï¼Œåƒåœ¾äº§ç”Ÿé‡æ€¥å‰§å¢åŠ ï¼Œç¯å¢ƒæ±¡æŸ“é—®é¢˜æ—¥ç›Šä¸¥é‡ã€‚åƒåœ¾åˆ†ç±»ä½œä¸ºä¸€ç§æœ‰æ•ˆçš„åƒåœ¾ç®¡ç†æ–¹å¼ï¼Œä¸ä»…æœ‰åŠ©äºèµ„æºçš„å›æ”¶åˆ©ç”¨ï¼Œè¿˜èƒ½å‡å°‘å¯¹ç¯å¢ƒçš„è´Ÿé¢å½±å“ã€‚ç„¶è€Œï¼Œä¼ ç»Ÿçš„åƒåœ¾åˆ†ç±»æ–¹æ³•ä¾èµ–äºäººå·¥è¯†åˆ«ï¼Œæ•ˆç‡ä½ä¸‹ä¸”å®¹æ˜“å‡ºé”™ã€‚å› æ­¤ï¼Œå¼€å‘ä¸€ç§é«˜æ•ˆã€å‡†ç¡®çš„åƒåœ¾åˆ†ç±»æ£€æµ‹ç³»ç»Ÿæ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚

è¿‘å¹´æ¥ï¼Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„è¿…çŒ›å‘å±•ä¸ºè®¡ç®—æœºè§†è§‰é¢†åŸŸå¸¦æ¥äº†æ–°çš„æœºé‡ã€‚YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶å¿«é€Ÿå’Œé«˜æ•ˆçš„ç›®æ ‡æ£€æµ‹èƒ½åŠ›è€Œå—åˆ°å¹¿æ³›å…³æ³¨ã€‚YOLOv11ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå…·å¤‡æ›´å¼ºçš„å®æ—¶æ£€æµ‹èƒ½åŠ›å’Œæ›´é«˜çš„å‡†ç¡®ç‡ï¼Œèƒ½å¤Ÿåœ¨å¤æ‚çš„è‡ªç„¶åœºæ™¯ä¸­æœ‰æ•ˆè¯†åˆ«å’Œåˆ†ç±»å¤šç§ç‰©ä½“ã€‚åŸºäºYOLOv11çš„è‡ªç„¶åœºæ™¯åƒåœ¾åˆ†ç±»æ£€æµ‹ç³»ç»Ÿï¼Œå°†ä¸ºåƒåœ¾åˆ†ç±»æä¾›ä¸€ç§æ™ºèƒ½åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚

æœ¬ç ”ç©¶æ‰€ä½¿ç”¨çš„æ•°æ®é›†TACOåŒ…å«3600å¼ å›¾åƒï¼Œæ¶µç›–59ç§åƒåœ¾ç±»åˆ«ï¼ŒåŒ…æ‹¬å¸¸è§çš„å¡‘æ–™ç“¶ã€çº¸ç›’ã€é‡‘å±ç½ç­‰ã€‚è¿™äº›ç±»åˆ«çš„å¤šæ ·æ€§ä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿå­¦ä¹ åˆ°ä¸°å¯Œçš„ç‰¹å¾ï¼Œä»è€Œæé«˜å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„æ³›åŒ–èƒ½åŠ›ã€‚æ­¤å¤–ï¼Œæ•°æ®é›†ä¸­çš„å®ä¾‹åˆ†å‰²æ ‡æ³¨ä¸ºæ¨¡å‹æä¾›äº†æ›´ä¸ºç²¾ç»†çš„è®­ç»ƒä¿¡æ¯ï¼Œä½¿å¾—æ£€æµ‹ç³»ç»Ÿèƒ½å¤Ÿåœ¨å¤æ‚ç¯å¢ƒä¸­æ›´å‡†ç¡®åœ°å®šä½å’Œåˆ†ç±»åƒåœ¾ã€‚

é€šè¿‡æ”¹è¿›YOLOv11æ¨¡å‹ï¼Œç»“åˆTACOæ•°æ®é›†çš„ä¸°å¯Œä¿¡æ¯ï¼Œæœ¬ç ”ç©¶æ—¨åœ¨æ„å»ºä¸€ä¸ªé«˜æ•ˆçš„è‡ªç„¶åœºæ™¯åƒåœ¾åˆ†ç±»æ£€æµ‹ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿä¸ä»…èƒ½å¤Ÿæé«˜åƒåœ¾åˆ†ç±»çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ï¼Œè¿˜å°†ä¸ºç¯å¢ƒä¿æŠ¤å’Œèµ„æºå›æ”¶æä¾›é‡è¦çš„æŠ€æœ¯æ”¯æŒï¼Œæ¨åŠ¨å¯æŒç»­å‘å±•çš„å®ç°ã€‚

### 2.è§†é¢‘æ•ˆæœ

[2.1 è§†é¢‘æ•ˆæœ](https://www.bilibili.com/video/BV1ujkQYGEds/)

### 3.å›¾ç‰‡æ•ˆæœ

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### [é¡¹ç›®æ¶‰åŠçš„æºç æ•°æ®æ¥æºé“¾æ¥](https://kdocs.cn/l/cszuIiCKVNis)**

æ³¨æ„ï¼šæœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,ç”±äºç‰ˆæœ¬æŒç»­æ›´æ–°,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,è¯·æŒ‰ç…§6.è®­ç»ƒæ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°ä¸Šå›¾æ¼”ç¤ºçš„æ•ˆæœã€‚

### 4.æ•°æ®é›†ä¿¡æ¯

##### 4.1 æœ¬é¡¹ç›®æ•°æ®é›†ç±»åˆ«æ•°ï¼†ç±»åˆ«å

nc: 59
names: ['Aerosol', 'Aluminium blister pack', 'Aluminium foil', 'Battery', 'Broken glass', 'Carded blister pack', 'Cigarette', 'Clear plastic bottle', 'Corrugated carton', 'Crisp packet', 'Disposable food container', 'Disposable plastic cup', 'Drink can', 'Drink carton', 'Egg carton', 'Foam cup', 'Foam food container', 'Food Can', 'Food waste', 'Garbage bag', 'Glass bottle', 'Glass cup', 'Glass jar', 'Magazine paper', 'Meal carton', 'Metal bottle cap', 'Metal lid', 'Normal paper', 'Other carton', 'Other plastic', 'Other plastic bottle', 'Other plastic container', 'Other plastic cup', 'Other plastic wrapper', 'Paper bag', 'Paper cup', 'Paper straw', 'Pizza box', 'Plastic bottle cap', 'Plastic film', 'Plastic glooves', 'Plastic lid', 'Plastic straw', 'Plastic utensils', 'Polypropylene bag', 'Pop tab', 'Rope - strings', 'Scrap metal', 'Shoe', 'Single-use carrier bag', 'Six pack rings', 'Spread tub', 'Squeezable tube', 'Styrofoam piece', 'Tissues', 'Toilet tube', 'Tupperware', 'Unlabeled litter', 'Wrapping paper']



è¯¥é¡¹ç›®ä¸ºã€å›¾åƒåˆ†å‰²ã€‘æ•°æ®é›†ï¼Œè¯·åœ¨ã€è®­ç»ƒæ•™ç¨‹å’ŒWebç«¯åŠ è½½æ¨¡å‹æ•™ç¨‹ï¼ˆç¬¬ä¸‰æ­¥ï¼‰ã€‘è¿™ä¸€æ­¥çš„æ—¶å€™æŒ‰ç…§ã€å›¾åƒåˆ†å‰²ã€‘éƒ¨åˆ†çš„æ•™ç¨‹æ¥è®­ç»ƒ

##### 4.2 æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»

æœ¬é¡¹ç›®æ•°æ®é›†ä¿¡æ¯ä»‹ç»ã€‚æœ¬é¡¹ç›®æ—¨åœ¨æ”¹è¿›YOLOv11çš„è‡ªç„¶åœºæ™¯åƒåœ¾åˆ†ç±»æ£€æµ‹ç³»ç»Ÿï¼Œæ‰€ä½¿ç”¨çš„æ•°æ®é›†ä¸ºâ€œTACOâ€ï¼Œè¯¥æ•°æ®é›†ä¸“æ³¨äºå¤šç§ç±»å‹çš„åƒåœ¾ç‰©å“ï¼Œæ¶µç›–äº†59ä¸ªä¸åŒçš„ç±»åˆ«ã€‚è¿™äº›ç±»åˆ«åŒ…æ‹¬ä»å¸¸è§çš„æ—¥å¸¸åƒåœ¾åˆ°ç‰¹å®šçš„åŒ…è£…ææ–™ï¼Œåæ˜ äº†ç°å®ç”Ÿæ´»ä¸­åƒåœ¾çš„å¤šæ ·æ€§å’Œå¤æ‚æ€§ã€‚å…·ä½“ç±»åˆ«å¦‚æ°”é›¾å‰‚ã€é“ç®”åŒ…è£…ã€åºŸæ—§ç”µæ± ã€ç ´ç¢ç»ç’ƒã€çº¸è´¨å’Œå¡‘æ–™å®¹å™¨ç­‰ï¼Œå‡ä¸ºæˆ‘ä»¬åœ¨åƒåœ¾åˆ†ç±»ä¸­ç»å¸¸é‡åˆ°çš„ç‰©å“ã€‚

æ•°æ®é›†ä¸­çš„æ¯ä¸ªç±»åˆ«éƒ½å…·æœ‰å…¶ç‹¬ç‰¹çš„ç‰¹å¾ï¼Œè¿™ä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­èƒ½å¤Ÿå­¦ä¹ åˆ°å¦‚ä½•åŒºåˆ†è¿™äº›ä¸åŒç±»å‹çš„åƒåœ¾ã€‚ä¾‹å¦‚ï¼Œé“ç®”åŒ…è£…å’Œå¡‘æ–™å®¹å™¨åœ¨å¤–è§‚ä¸Šå¯èƒ½ç›¸ä¼¼ï¼Œä½†å®ƒä»¬çš„æè´¨å’Œå¯å›æ”¶æ€§å´å¤§ç›¸å¾„åº­ã€‚å› æ­¤ï¼Œå‡†ç¡®çš„åˆ†ç±»ä¸ä»…æœ‰åŠ©äºæé«˜åƒåœ¾å¤„ç†çš„æ•ˆç‡ï¼Œä¹Ÿèƒ½ä¿ƒè¿›èµ„æºçš„å†åˆ©ç”¨å’Œç¯å¢ƒä¿æŠ¤ã€‚

æ­¤å¤–ï¼Œæ•°æ®é›†ä¸­è¿˜åŒ…å«äº†ä¸€äº›ä¸æ˜“åˆ†ç±»çš„ç‰©å“ï¼Œå¦‚â€œæœªæ ‡è®°åƒåœ¾â€ï¼Œè¿™ä¸ºæ¨¡å‹çš„è®­ç»ƒæä¾›äº†æ›´å¤§çš„æŒ‘æˆ˜ï¼ŒåŒæ—¶ä¹Ÿå¢å¼ºäº†å…¶åœ¨å®é™…åº”ç”¨ä¸­çš„é€‚åº”æ€§ã€‚é€šè¿‡å¯¹è¿™äº›å¤šæ ·åŒ–åƒåœ¾çš„è¯†åˆ«ä¸åˆ†ç±»ï¼Œæ”¹è¿›åçš„YOLOv11æ¨¡å‹å°†èƒ½å¤Ÿåœ¨å¤æ‚çš„è‡ªç„¶åœºæ™¯ä¸­è¡¨ç°å‡ºæ›´é«˜çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ï¼Œä»è€Œä¸ºåƒåœ¾åˆ†ç±»å’Œç¯å¢ƒä¿æŠ¤å·¥ä½œæä¾›æœ‰åŠ›æ”¯æŒã€‚

æ€»ä¹‹ï¼ŒTACOæ•°æ®é›†ä¸ºæœ¬é¡¹ç›®æä¾›äº†ä¸°å¯Œçš„è®­ç»ƒç´ æï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿåœ¨å®é™…åº”ç”¨ä¸­æ›´æœ‰æ•ˆåœ°åº”å¯¹åƒåœ¾åˆ†ç±»çš„æŒ‘æˆ˜ï¼Œæ¨åŠ¨å¯æŒç»­å‘å±•çš„ç›®æ ‡ã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 æ‰€éœ€è½¯ä»¶PyCharmå’ŒAnacondaå®‰è£…æ•™ç¨‹ï¼ˆç¬¬ä¸€æ­¥ï¼‰](https://www.bilibili.com/video/BV1BoC1YCEKi/?spm_id_from=333.999.0.0&vd_source=bc9aec86d164b67a7004b996143742dc)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹ï¼ˆç¬¬äºŒæ­¥ï¼‰](https://www.bilibili.com/video/BV1ZoC1YCEBw?spm_id_from=333.788.videopod.sections&vd_source=bc9aec86d164b67a7004b996143742dc)

### 6.æ”¹è¿›YOLOv11è®­ç»ƒæ•™ç¨‹å’ŒWeb_UIå‰ç«¯åŠ è½½æ¨¡å‹æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[6.1 æ”¹è¿›YOLOv11è®­ç»ƒæ•™ç¨‹å’ŒWeb_UIå‰ç«¯åŠ è½½æ¨¡å‹æ•™ç¨‹ï¼ˆç¬¬ä¸‰æ­¥ï¼‰](https://www.bilibili.com/video/BV1BoC1YCEhR?spm_id_from=333.788.videopod.sections&vd_source=bc9aec86d164b67a7004b996143742dc)


æŒ‰ç…§ä¸Šé¢çš„è®­ç»ƒè§†é¢‘æ•™ç¨‹é“¾æ¥åŠ è½½é¡¹ç›®æä¾›çš„æ•°æ®é›†ï¼Œè¿è¡Œtrain.pyå³å¯å¼€å§‹è®­ç»ƒ
ï»¿


     Epoch   gpu_mem       box       obj       cls    labels  img_size
     1/200     20.8G   0.01576   0.01955  0.007536        22      1280: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 849/849 [14:42<00:00,  1.04s/it]
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 213/213 [01:14<00:00,  2.87it/s]
                 all       3395      17314      0.994      0.957      0.0957      0.0843

     Epoch   gpu_mem       box       obj       cls    labels  img_size
     2/200     20.8G   0.01578   0.01923  0.007006        22      1280: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 849/849 [14:44<00:00,  1.04s/it]
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 213/213 [01:12<00:00,  2.95it/s]
                 all       3395      17314      0.996      0.956      0.0957      0.0845

     Epoch   gpu_mem       box       obj       cls    labels  img_size
     3/200     20.8G   0.01561    0.0191  0.006895        27      1280: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 849/849 [10:56<00:00,  1.29it/s]
               Class     Images     Labels          P          R     mAP@.5 mAP@.5:.95: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 187/213 [00:52<00:00,  4.04it/s]
                 all       3395      17314      0.996      0.957      0.0957      0.0845




###### [é¡¹ç›®æ•°æ®é›†ä¸‹è½½é“¾æ¥](https://kdocs.cn/l/cszuIiCKVNis)

### 7.åŸå§‹YOLOv11ç®—æ³•è®²è§£



###### YOLOv11æ”¹è¿›æ–¹å‘

ä¸YOLOv 10ç›¸æ¯”ï¼ŒYOLOv 11æœ‰äº†å·¨å¤§çš„æ”¹è¿›ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

  * å¢å¼ºçš„æ¨¡å‹ç»“æ„ï¼šæ¨¡å‹å…·æœ‰æ”¹è¿›çš„æ¨¡å‹ç»“æ„ï¼Œä»¥è·å–å›¾åƒå¤„ç†å¹¶å½¢æˆé¢„æµ‹
  * GPUä¼˜åŒ–ï¼šè¿™æ˜¯ç°ä»£MLæ¨¡å‹çš„åæ˜ ï¼ŒGPUè®­ç»ƒMLæ¨¡å‹åœ¨é€Ÿåº¦å’Œå‡†ç¡®æ€§ä¸Šéƒ½æ›´å¥½ã€‚
  * é€Ÿåº¦ï¼šYOLOv 11æ¨¡å‹ç°åœ¨ç»è¿‡å¢å¼ºå’ŒGPUä¼˜åŒ–ä»¥ç”¨äºè®­ç»ƒã€‚é€šè¿‡ä¼˜åŒ–ï¼Œè¿™äº›æ¨¡å‹æ¯”å®ƒä»¬çš„å‰ç‰ˆæœ¬å¿«å¾—å¤šã€‚åœ¨é€Ÿåº¦ä¸Šè¾¾åˆ°äº†25%çš„å»¶è¿Ÿå‡å°‘ï¼
  * æ›´å°‘çš„å‚æ•°ï¼šæ›´å°‘çš„å‚æ•°å…è®¸æ›´å¿«çš„æ¨¡å‹ï¼Œä½†v11çš„å‡†ç¡®æ€§ä¸å—å½±å“
  * æ›´å…·é€‚åº”æ€§ï¼šæ›´å¤šæ”¯æŒçš„ä»»åŠ¡YOLOv 11æ”¯æŒå¤šç§ç±»å‹çš„ä»»åŠ¡ã€å¤šç§ç±»å‹çš„å¯¹è±¡å’Œå¤šç§ç±»å‹çš„å›¾åƒã€‚

###### YOLOv11åŠŸèƒ½ä»‹ç»

Glenn Jocherå’Œä»–çš„å›¢é˜Ÿåˆ¶ä½œäº†ä¸€ä¸ªä»¤äººæ•¬ç•çš„YOLOv 11è¿­ä»£ï¼Œå¹¶ä¸”åœ¨å›¾åƒäººå·¥æ™ºèƒ½çš„å„ä¸ªæ–¹é¢éƒ½æä¾›äº†YOLOã€‚YOLOv 11æœ‰å¤šç§å‹å·ï¼ŒåŒ…æ‹¬ï¼š

  * å¯¹è±¡æ£€æµ‹-åœ¨è®­ç»ƒæ—¶æ£€æµ‹å›¾åƒä¸­çš„å¯¹è±¡
  * å›¾åƒåˆ†å‰²-è¶…è¶Šå¯¹è±¡æ£€æµ‹ï¼Œåˆ†å‰²å‡ºå›¾åƒä¸­çš„å¯¹è±¡
  * å§¿æ€æ£€æµ‹-å½“ç”¨ç‚¹å’Œçº¿è®­ç»ƒæ—¶ç»˜åˆ¶ä¸€ä¸ªäººçš„å§¿åŠ¿
  * å®šå‘æ£€æµ‹ï¼ˆOBBï¼‰ï¼šç±»ä¼¼äºå¯¹è±¡æ£€æµ‹ï¼Œä½†åŒ…å›´ç›’å¯ä»¥æ—‹è½¬
  * å›¾åƒåˆ†ç±»-åœ¨è®­ç»ƒæ—¶å¯¹å›¾åƒè¿›è¡Œåˆ†ç±»

ä½¿ç”¨Ultralytics Libraryï¼Œè¿™äº›æ¨¡å‹è¿˜å¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œä»¥ï¼š

  * è·Ÿè¸ª-å¯ä»¥è·Ÿè¸ªå¯¹è±¡çš„è·¯å¾„
  * æ˜“äºå¯¼å‡º-åº“å¯ä»¥ä»¥ä¸åŒçš„æ ¼å¼å’Œç›®çš„å¯¼å‡º
  * å¤šåœºæ™¯-æ‚¨å¯ä»¥é’ˆå¯¹ä¸åŒçš„å¯¹è±¡å’Œå›¾åƒè®­ç»ƒæ¨¡å‹

æ­¤å¤–ï¼ŒUltralyticsè¿˜æ¨å‡ºäº†YOLOv 11çš„ä¼ä¸šæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å°†äº10æœˆ31æ—¥å‘å¸ƒã€‚è¿™å°†ä¸å¼€æºçš„YOLOv
11æ¨¡å‹å¹¶è¡Œï¼Œä½†å°†æ‹¥æœ‰æ›´å¤§çš„ä¸“æœ‰Ultralyticsæ•°æ®é›†ã€‚YOLOv 11æ˜¯â€œå»ºç«‹åœ¨è¿‡å»çš„æˆåŠŸâ€çš„å…¶ä»–ç‰ˆæœ¬çš„ä¹‹ä¸Šã€‚

###### YOLOv11æ¨¡å‹ä»‹ç»

YOLOv 11é™„å¸¦äº†è¾¹ç•Œæ¡†æ¨¡å‹ï¼ˆæ— åç¼€ï¼‰ï¼Œå®ä¾‹åˆ†å‰²ï¼ˆ-segï¼‰ï¼Œå§¿æ€ä¼°è®¡ï¼ˆ-poseï¼‰ï¼Œå®šå‘è¾¹ç•Œæ¡†ï¼ˆ-obbï¼‰å’Œåˆ†ç±»ï¼ˆ-clsï¼‰ã€‚

è¿™äº›ä¹Ÿæœ‰ä¸åŒçš„å°ºå¯¸ï¼šçº³ç±³ï¼ˆnï¼‰ï¼Œå°ï¼ˆsï¼‰ï¼Œä¸­ï¼ˆmï¼‰ï¼Œå¤§ï¼ˆlï¼‰ï¼Œè¶…å¤§ï¼ˆxï¼‰ã€‚

![img](https://img-
blog.csdnimg.cn/img_convert/e2ac12a32b7ca425217ea8391736d9ca.png)

YOLOv11æ¨¡å‹

###### YOLOv11ä¸å‰ç‰ˆæœ¬å¯¹æ¯”

ä¸YOLOv10å’ŒYOLOv8ç›¸æ¯”ï¼ŒYOLOv11åœ¨Ultralyticsçš„ä»»ä½•å¸–å­ä¸­éƒ½æ²¡æœ‰ç›´æ¥æåˆ°ã€‚æ‰€ä»¥æˆ‘ä¼šæ”¶é›†æ‰€æœ‰çš„æ•°æ®æ¥æ¯”è¾ƒå®ƒä»¬ã€‚æ„Ÿè°¢Ultralyticsï¼š

**æ£€æµ‹ï¼š**

![img](https://img-
blog.csdnimg.cn/img_convert/e7bc7f5fbb8ca2db5460668b96237f2d.png)

YOLOv11æ£€æµ‹ç»Ÿè®¡

![img](https://img-
blog.csdnimg.cn/img_convert/b6836b131f872e1fd122404157de1e86.png)

YOLOv10æ£€æµ‹ç»Ÿè®¡

å…¶ä¸­ï¼ŒNanoçš„mAPvalåœ¨v11ä¸Šä¸º39.5ï¼Œv10ä¸Šä¸º38.5ï¼›Smallä¸º47.0 vs 46.3ï¼ŒMediumä¸º51.5 vs
51.1ï¼ŒLargeä¸º53.4 vs 53.2ï¼ŒExtra Largeä¸º54.7vs
54.4ã€‚ç°åœ¨ï¼Œè¿™å¯èƒ½çœ‹èµ·æ¥åƒæ˜¯ä¸€ç§å¢é‡å¢åŠ ï¼Œä½†å°å°æ•°çš„å¢åŠ å¯èƒ½ä¼šå¯¹MLæ¨¡å‹äº§ç”Ÿå¾ˆå¤§å½±å“ã€‚æ€»ä½“è€Œè¨€ï¼ŒYOLOv11ä»¥0.3
mAPvalçš„ä¼˜åŠ¿è¿½å¹³æˆ–å‡»è´¥YOLOv10ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å¿…é¡»çœ‹çœ‹é€Ÿåº¦ã€‚åœ¨å»¶è¿Ÿæ–¹é¢ï¼ŒNanoåœ¨v11ä¸Šä¸º1.55 , v10ä¸Šä¸º1.84ï¼ŒSmallä¸º2.46 v2.49ï¼ŒMediumä¸º4.70
v4.74ï¼ŒLargeä¸º6.16 v7.28ï¼ŒExtra Largeä¸º11.31
v10.70ã€‚å»¶è¿Ÿè¶Šä½è¶Šå¥½ã€‚YOLOv11æä¾›äº†ä¸€ä¸ªéå¸¸ä½çš„å»¶è¿Ÿç›¸æ¯”ï¼Œé™¤äº†ç‰¹å¤§åšå¾—ç›¸å½“å·®çš„å‰èº«ã€‚

æ€»çš„æ¥è¯´ï¼ŒNanoæ¨¡å‹æ˜¯ä»¤äººæŒ¯å¥‹çš„ï¼Œé€Ÿåº¦æ›´å¿«ï¼Œæ€§èƒ½ç›¸å½“ã€‚Extra Largeåœ¨æ€§èƒ½ä¸Šæœ‰å¾ˆå¥½çš„æå‡ï¼Œä½†å®ƒçš„å»¶è¿Ÿéå¸¸ç³Ÿç³•ã€‚

**åˆ†å‰²ï¼š**

![img](https://img-
blog.csdnimg.cn/img_convert/c4280d74fb735c5efdeec096ddafe027.png)

YOLOV11 åˆ†å‰²ç»Ÿè®¡

![img](https://img-
blog.csdnimg.cn/img_convert/8500756f76cb2277280639aab069a22a.png)

YOLOV9 åˆ†å‰²ç»Ÿè®¡

![img](https://img-
blog.csdnimg.cn/img_convert/a1f20d5fcab6323c2aea543136374876.png)

YOLOV8 åˆ†å‰²æ•°æ®

æ€»ä½“è€Œè¨€ï¼ŒYOLOv 11ä¸Šçš„åˆ†å‰²æ¨¡å‹åœ¨å¤§å‹å’Œè¶…å¤§å‹æ¨¡å‹æ–¹é¢æ¯”ä¸Šä¸€ä»£YOLOv 8å’ŒYOLOv 9åšå¾—æ›´å¥½ã€‚

YOLOv 9 Segmentationæ²¡æœ‰æä¾›ä»»ä½•å…³äºå»¶è¿Ÿçš„ç»Ÿè®¡æ•°æ®ã€‚æ¯”è¾ƒYOLOv 11å»¶è¿Ÿå’ŒYOLOv 8å»¶è¿Ÿï¼Œå‘ç°YOLOv 11æ¯”YOLOv
8å¿«å¾—å¤šã€‚YOLOv 11å°†å¤§é‡GPUé›†æˆåˆ°ä»–ä»¬çš„æ¨¡å‹ä¸­ï¼Œå› æ­¤æœŸæœ›ä»–ä»¬çš„æ¨¡å‹ç”šè‡³æ¯”CPUæµ‹è¯•çš„åŸºå‡†æ›´å¿«ï¼

å§¿æ€ä¼°è®¡ï¼š

![img](https://img-
blog.csdnimg.cn/img_convert/b8e15e57098723453b6cdc9eda75118e.png)

YOLOV11å§¿æ€ä¼°è®¡ç»Ÿè®¡

![img](https://img-
blog.csdnimg.cn/img_convert/515264f7dd14fed8e2ece60c1c94806b.png)

YOLOV8å§¿æ€ä¼°è®¡ç»Ÿè®¡

YOLOv 11çš„mAP 50 -95ç»Ÿè®¡é‡ä¹Ÿé€æ¸ä¼˜äºå…ˆå‰çš„YOLOv 8ï¼ˆé™¤å¤§å‹å¤–ï¼‰ã€‚ç„¶è€Œï¼Œåœ¨é€Ÿåº¦æ–¹é¢ï¼ŒYOLOv
11å§¿åŠ¿å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å»¶è¿Ÿã€‚å…¶ä¸­ä¸€äº›å»¶è¿ŸæŒ‡æ ‡æ˜¯ç‰ˆæœ¬çš„1/4ï¼é€šè¿‡å¯¹è¿™äº›æ¨¡å‹è¿›è¡ŒGPUè®­ç»ƒä¼˜åŒ–ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æŒ‡æ ‡æ¯”æ˜¾ç¤ºçš„è¦å¥½å¾—å¤šã€‚

**å®šå‘è¾¹ç•Œæ¡†ï¼š**

![img](https://img-
blog.csdnimg.cn/img_convert/fa4ce5fe7fdc44bb11a9b5d1842e32a6.png)

YOLOv11 OBBç»Ÿè®¡

![img](https://img-
blog.csdnimg.cn/img_convert/68f498919bc731806f5b24c0a0f317f5.png)

YOLOv8 OBBç»Ÿè®¡

OBBç»Ÿè®¡æ•°æ®åœ¨mAP
50ä¸Šå¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œåªæœ‰éå¸¸å°çš„æ”¹è¿›ï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šå°äºæ£€æµ‹ä¸­çš„å¾®å°æ”¹è¿›ã€‚ç„¶è€Œï¼Œä»v8åˆ°v11çš„é€Ÿåº¦å‡åŠï¼Œè¿™è¡¨æ˜YOLOv11åœ¨é€Ÿåº¦ä¸Šåšäº†å¾ˆå¤šåŠªåŠ›ã€‚

**æœ€åï¼Œåˆ†ç±»ï¼š**

![img](https://img-
blog.csdnimg.cn/img_convert/99c9a2edbcb11ba9bc66e1dc7006ed75.png)

YOLOv 11 CLSç»Ÿè®¡

![img](https://img-
blog.csdnimg.cn/img_convert/4aa0a6e2dba8fc65ed529c1487665eb7.png)

YOLOv8 CLSç»Ÿè®¡

ä»v8åˆ°v11ï¼Œå‡†ç¡®æ€§ä¹Ÿæœ‰äº†å¾®å°çš„æé«˜ã€‚ç„¶è€Œï¼Œé€Ÿåº¦å¤§å¹…ä¸Šå‡ï¼ŒCPUé€Ÿåº¦æ›´å¿«çš„å‹å·ã€‚



### 8.200+ç§å…¨å¥—æ”¹è¿›YOLOV11åˆ›æ–°ç‚¹åŸç†è®²è§£

#### 8.1 200+ç§å…¨å¥—æ”¹è¿›YOLOV11åˆ›æ–°ç‚¹åŸç†è®²è§£å¤§å…¨

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸å…¨éƒ¨å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„æ”¹è¿›æ¨¡å—å¯¹åº”é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼ˆåˆ›æ–°ç‚¹å‡ä¸ºæ¨¡å—åŒ–æ­å»ºï¼ŒåŸç†é€‚é…YOLOv5~YOLOv11ç­‰å„ç§ç‰ˆæœ¬ï¼‰

[æ”¹è¿›æ¨¡å—æŠ€æœ¯åŸç†åšå®¢ã€Blogã€‘ç½‘å€é“¾æ¥](https://gitee.com/qunmasj/good)

![9.png](9.png)

#### 8.2 ç²¾é€‰éƒ¨åˆ†æ”¹è¿›YOLOV11åˆ›æ–°ç‚¹åŸç†è®²è§£

###### è¿™é‡ŒèŠ‚é€‰éƒ¨åˆ†æ”¹è¿›åˆ›æ–°ç‚¹å±•å¼€åŸç†è®²è§£(å®Œæ•´çš„æ”¹è¿›åŸç†è§ä¸Šå›¾å’Œ[æ”¹è¿›æ¨¡å—æŠ€æœ¯åŸç†åšå®¢é“¾æ¥](https://gitee.com/qunmasj/good)ã€å¦‚æœæ­¤å°èŠ‚çš„å›¾åŠ è½½å¤±è´¥å¯ä»¥é€šè¿‡CSDNæˆ–è€…Githubæœç´¢è¯¥åšå®¢çš„æ ‡é¢˜è®¿é—®åŸå§‹åšå®¢ï¼ŒåŸå§‹åšå®¢å›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸ã€‘
ï»¿

### OREPAï¼šåœ¨çº¿å·ç§¯é‡å‚æ•°åŒ–
å·ç§¯ç¥ç»ç½‘ç»œ(CNNs)å·²ç»åœ¨è®¸å¤šè®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„åº”ç”¨æˆåŠŸï¼ŒåŒ…æ‹¬å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€è¯­ä¹‰åˆ†å‰²ç­‰ã€‚ç²¾åº¦å’Œæ¨¡å‹æ•ˆç‡ä¹‹é—´çš„æƒè¡¡ä¹Ÿå·²è¢«å¹¿æ³›è®¨è®ºã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªç²¾åº¦è¾ƒé«˜çš„æ¨¡å‹é€šå¸¸éœ€è¦ä¸€ä¸ªæ›´å¤æ‚çš„å—ï¼Œä¸€ä¸ªæ›´å®½æˆ–æ›´æ·±çš„ç»“æ„ã€‚ç„¶è€Œï¼Œè¿™æ ·çš„æ¨¡å‹æ€»æ˜¯å¤ªé‡ï¼Œæ— æ³•éƒ¨ç½²ï¼Œç‰¹åˆ«æ˜¯åœ¨ç¡¬ä»¶æ€§èƒ½æœ‰é™ã€éœ€è¦å®æ—¶æ¨ç†çš„åœºæ™¯ä¸‹ã€‚è€ƒè™‘åˆ°æ•ˆç‡ï¼Œæ›´å°ã€æ›´ç´§å‡‘å’Œæ›´å¿«çš„æ¨¡å‹è‡ªç„¶æ˜¯é¦–é€‰ã€‚

ä¸ºäº†è·å¾—ä¸€ä¸ªéƒ¨ç½²å‹å¥½ä¸”é«˜ç²¾åº¦çš„æ¨¡å‹ï¼Œæœ‰ç ”ç©¶è€…æå‡ºäº†åŸºäºç»“æ„é‡å‚æ•°åŒ–çš„æ–¹æ³•æ¥é‡Šæ”¾æ€§èƒ½ã€‚åœ¨è¿™äº›æ–¹æ³•ä¸­ï¼Œæ¨¡å‹åœ¨è®­ç»ƒé˜¶æ®µå’Œæ¨ç†é˜¶æ®µæœ‰ä¸åŒçš„ç»“æ„ã€‚å…·ä½“æ¥è¯´ï¼Œä½¿ç”¨å¤æ‚çš„è®­ç»ƒé˜¶æ®µæ‹“æ‰‘ï¼Œå³é‡å‚æ•°åŒ–çš„å—ï¼Œæ¥æé«˜æ€§èƒ½ã€‚è®­ç»ƒç»“æŸåï¼Œé€šè¿‡ç­‰æ•ˆå˜æ¢å°†ä¸€ä¸ªå¤æ‚çš„å—é‡å‚ä¸ºæˆä¸€ä¸ªå•ä¸€çš„çº¿æ€§å±‚ã€‚é‡å‚åçš„æ¨¡å‹é€šå¸¸å…·æœ‰ä¸€ä¸ªæ•´æ´æ¶æ„æ¨¡å‹ï¼Œä¾‹å¦‚ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªç±»ä¼¼VGGçš„æˆ–ä¸€ä¸ªç±»ä¼¼ResNetçš„ç»“æ„ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œé‡å‚åŒ–ç­–ç•¥å¯ä»¥åœ¨ä¸å¼•å…¥é¢å¤–çš„æ¨ç†æ—¶é—´æˆæœ¬çš„æƒ…å†µä¸‹æé«˜æ¨¡å‹çš„æ€§èƒ½ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/e365c93892dc4a0b9cd641778907349e.png)

BNå±‚æ˜¯é‡æ„æ¨¡å‹çš„å…³é”®ç»„æˆéƒ¨åˆ†ã€‚åœ¨ä¸€ä¸ªé‡æ–°è§£æå—(å›¾1(b))ä¸­ï¼Œåœ¨æ¯ä¸ªå·ç§¯å±‚ä¹‹åç«‹å³æ·»åŠ ä¸€ä¸ªBNå±‚ã€‚å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œå»é™¤è¿™äº›BNå±‚ä¼šå¯¼è‡´çš„æ€§èƒ½é€€åŒ–ã€‚ç„¶è€Œï¼Œå½“è€ƒè™‘åˆ°æ•ˆç‡æ—¶ï¼Œè¿™ç§BNå±‚çš„ä½¿ç”¨å‡ºä¹æ„æ–™åœ°åœ¨è®­ç»ƒé˜¶æ®µå¸¦æ¥äº†å·¨å¤§çš„è®¡ç®—å¼€é”€ã€‚åœ¨æ¨ç†é˜¶æ®µï¼Œå¤æ‚çš„å—å¯ä»¥è¢«å‹ç¼©æˆä¸€ä¸ªå·ç§¯å±‚ã€‚ä½†æ˜¯ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒBNå±‚æ˜¯éçº¿æ€§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬å°†ç‰¹å¾æ˜ å°„é™¤ä»¥å®ƒçš„æ ‡å‡†å·®ï¼Œè¿™å°±é˜»æ­¢äº†åˆå¹¶æ•´ä¸ªå—ã€‚å› æ­¤ï¼Œå­˜åœ¨å¤§é‡çš„ä¸­é—´è®¡ç®—æ“ä½œ(large FLOPS)å’Œç¼“å†²ç‰¹å¾æ˜ å°„(high memory usage)ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™ä¹ˆé«˜çš„è®­ç»ƒé¢„ç®—ä½¿å¾—å¾ˆéš¾æ¢ç´¢æ›´å¤æ‚å’Œå¯èƒ½æ›´å¼ºçš„é‡å‚å—ã€‚å¾ˆè‡ªç„¶åœ°ï¼Œä¸‹é¢çš„é—®é¢˜å°±å‡ºç°äº†ï¼š

ä¸ºä»€ä¹ˆæ ‡å‡†åŒ–åœ¨é‡å‚ä¸­è¿™ä¹ˆé‡è¦ï¼Ÿ

é€šè¿‡åˆ†æå’Œå®éªŒï¼Œä½œè€…è®¤ä¸ºBNå±‚ä¸­çš„å°ºåº¦å› å­æœ€é‡è¦ï¼Œå› ä¸ºå®ƒä»¬èƒ½å¤Ÿä½¿ä¸åŒåˆ†æ”¯çš„ä¼˜åŒ–æ–¹å‘å¤šæ ·åŒ–ã€‚

åŸºäºè§‚å¯Ÿç»“æœï¼Œä½œè€…æå‡ºäº†åœ¨çº¿é‡å‚åŒ–(OREPA)(å›¾1(c))ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¤é˜¶æ®µçš„pipelineï¼Œä½¿ä¹‹èƒ½å¤Ÿç®€åŒ–å¤æ‚çš„training-time re-param blockã€‚

åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œblock linearizationï¼Œå»é™¤æ‰€æœ‰çš„éçº¿æ€§BNå±‚ï¼Œå¹¶å¼•å…¥çº¿æ€§ç¼©æ”¾å±‚ã€‚è¿™äº›å±‚ä¸BNå±‚å…·æœ‰ç›¸ä¼¼çš„æ€§è´¨ï¼Œå› æ­¤å®ƒä»¬ä½¿ä¸åŒåˆ†æ”¯çš„ä¼˜åŒ–å¤šæ ·åŒ–ã€‚æ­¤å¤–ï¼Œè¿™äº›å±‚éƒ½æ˜¯çº¿æ€§çš„ï¼Œå¯ä»¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åˆå¹¶æˆå·ç§¯å±‚ã€‚

ç¬¬äºŒé˜¶æ®µï¼Œblock squeezingï¼Œå°†å¤æ‚çš„çº¿æ€§å—ç®€åŒ–ä¸ºå•ä¸€çš„å·ç§¯å±‚ã€‚OREPAé€šè¿‡å‡å°‘ç”±ä¸­é—´è®¡ç®—å±‚å¼•èµ·çš„è®¡ç®—å’Œå­˜å‚¨å¼€é”€ï¼Œæ˜¾è‘—é™ä½äº†è®­ç»ƒæˆæœ¬ï¼Œå¯¹æ€§èƒ½åªæœ‰éå¸¸å°çš„å½±å“ã€‚

æ­¤å¤–ï¼Œé«˜æ•ˆåŒ–ä½¿å¾—æ¢ç´¢æ›´å¤æ‚çš„é‡å‚åŒ–æ‹“æ‰‘æˆä¸ºå¯èƒ½ã€‚ä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œä½œè€…è¿›ä¸€æ­¥æå‡ºäº†å‡ ä¸ªé‡å‚åŒ–çš„ç»„ä»¶ï¼Œä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚

åœ¨ImageNetåˆ†ç±»ä»»åŠ¡ä¸Šè¯„ä¼°äº†æ‰€æå‡ºçš„OREPAã€‚ä¸æœ€å…ˆè¿›çš„ä¿®å¤æ¨¡å‹ç›¸æ¯”ï¼ŒOREPAå°†é¢å¤–çš„è®­ç»ƒæ—¶é—´GPUå†…å­˜æˆæœ¬é™ä½äº†65%åˆ°75%ï¼Œå¹¶å°†è®­ç»ƒè¿‡ç¨‹åŠ å¿«äº†1.5-2.3å€ã€‚åŒæ—¶ï¼ŒOREPA-ResNetå’ŒOREPA-VGGçš„æ€§èƒ½å§‹ç»ˆä¼˜äº+0.2%âˆ¼+0.6%ä¹‹å‰çš„DBBå’ŒRepVGGæ–¹æ³•ã€‚åŒæ—¶ä½œè€…è¿˜è¯„ä¼°äº†åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šçš„OREPAï¼Œå³ç›®æ ‡æ£€æµ‹å’Œè¯­ä¹‰åˆ†å‰²ã€‚ä½œè€…å‘ç°OREPAå¯ä»¥åœ¨è¿™äº›ä»»åŠ¡ä¸Šä¹Ÿå¯ä»¥å¸¦æ¥æ€§èƒ½çš„æé«˜ã€‚

æå‡ºäº†åœ¨çº¿å·ç§¯é‡å‚åŒ–(OREPA)ç­–ç•¥ï¼Œè¿™æå¤§åœ°æé«˜äº†é‡å‚åŒ–æ¨¡å‹çš„è®­ç»ƒæ•ˆç‡ï¼Œå¹¶ä½¿æ¢ç´¢æ›´å¼ºçš„é‡å‚åŒ–å—æˆä¸ºå¯èƒ½ï¼›

é€šè¿‡å¯¹é‡å‚åŒ–æ¨¡å‹å·¥ä½œæœºåˆ¶çš„åˆ†æï¼Œç”¨å¼•å…¥çš„çº¿æ€§å°ºåº¦å±‚ä»£æ›¿BNå±‚ï¼Œè¿™ä»ç„¶æä¾›äº†ä¸åŒçš„ä¼˜åŒ–æ–¹å‘ï¼Œå¹¶ä¿æŒäº†è¡¨ç¤ºèƒ½åŠ›;

åœ¨å„ç§è§†è§‰ä»»åŠ¡ä¸Šçš„å®éªŒè¡¨æ˜ï¼ŒOREPAåœ¨å‡†ç¡®æ€§å’Œè®­ç»ƒæ•ˆç‡æ–¹é¢éƒ½ä¼˜äºä»¥å‰çš„é‡å‚åŒ–æ¨¡å‹(DBB/RepVGG)ã€‚


#### ç»“æ„é‡å‚åŒ–
ç»“æ„é‡å‚åŒ–æœ€è¿‘è¢«é‡è§†å¹¶åº”ç”¨äºè®¸å¤šè®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼Œå¦‚ç´§å‡‘æ¨¡å‹è®¾è®¡ã€æ¶æ„æœç´¢å’Œå‰ªæã€‚é‡å‚åŒ–æ„å‘³ç€ä¸åŒçš„æ¶æ„å¯ä»¥é€šè¿‡å‚æ•°çš„ç­‰ä»·è½¬æ¢æ¥ç›¸äº’è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œ1Ã—1å·ç§¯çš„ä¸€ä¸ªåˆ†æ”¯å’Œ3Ã—3å·ç§¯çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå¯ä»¥è½¬ç§»åˆ°3Ã—3å·ç§¯çš„å•ä¸ªåˆ†æ”¯ä¸­ã€‚åœ¨è®­ç»ƒé˜¶æ®µï¼Œè®¾è®¡äº†å¤šåˆ†æ”¯å’Œå¤šå±‚æ‹“æ‰‘æ¥å–ä»£æ™®é€šçš„çº¿æ€§å±‚(å¦‚convæˆ–å…¨è¿æ¥å±‚)æ¥å¢å¼ºæ¨¡å‹ã€‚Caoç­‰è®¨è®ºäº†å¦‚ä½•åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åˆå¹¶æ·±åº¦å¯åˆ†ç¦»å·ç§¯æ ¸ã€‚ç„¶ååœ¨æ¨ç†è¿‡ç¨‹ä¸­ï¼Œå°†è®­ç»ƒæ—¶é—´çš„å¤æ‚æ¨¡å‹è½¬ç§»åˆ°ç®€å•æ¨¡å‹ä¸­ï¼Œä»¥ä¾¿äºæ›´å¿«çš„æ¨ç†ã€‚

åœ¨å—ç›Šäºå¤æ‚çš„training-timeæ‹“æ‰‘ï¼ŒåŒæ—¶ï¼Œå½“å‰çš„é‡å‚åŒ–æ–¹æ³•è®­ç»ƒä½¿ç”¨ä¸å¯å¿½ç•¥çš„é¢å¤–è®¡ç®—æˆæœ¬ã€‚å½“å—å˜å¾—æ›´å¤æ‚ä»¥å˜å¾—æ›´å¼ºçš„è¡¨ç¤ºæ—¶ï¼ŒGPUå†…å­˜åˆ©ç”¨ç‡å’Œè®­ç»ƒæ—¶é—´å°†ä¼šè¶Šæ¥è¶Šé•¿ï¼Œæœ€ç»ˆèµ°å‘ä¸å¯æ¥å—ã€‚ä¸ä»¥å¾€çš„é‡å‚åŒ–æ–¹æ³•ä¸åŒï¼Œæœ¬æ–‡æ›´å¤šåœ°å…³æ³¨è®­ç»ƒæˆæœ¬ã€‚æå‡ºäº†ä¸€ç§é€šç”¨çš„åœ¨çº¿å·ç§¯é‡å‚åŒ–ç­–ç•¥ï¼Œä½¿training-timeçš„ç»“æ„é‡å‚åŒ–æˆä¸ºå¯èƒ½ã€‚


#### Normalization
BNè¢«æå‡ºæ¥ç¼“è§£è®­ç»ƒéå¸¸æ·±åº¦ç¥ç»ç½‘ç»œæ—¶çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚äººä»¬è®¤ä¸ºBNå±‚æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºå®ƒä»¬å¹³æ»‘äº†æŸå¤±ã€‚æœ€è¿‘å…³äºæ— BNç¥ç»ç½‘ç»œçš„ç ”ç©¶å£°ç§°ï¼ŒBNå±‚å¹¶ä¸æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚é€šè¿‡è‰¯å¥½çš„åˆå§‹åŒ–å’Œé€‚å½“çš„æ­£åˆ™åŒ–ï¼Œå¯ä»¥ä¼˜é›…åœ°å»é™¤BNå±‚ã€‚

å¯¹äºé‡å‚åŒ–æ¨¡å‹ï¼Œä½œè€…è®¤ä¸ºé‡å‚åŒ–å—ä¸­çš„BNå±‚æ˜¯å…³é”®çš„ã€‚æ— BNçš„å˜ä½“å°†ä¼šå‡ºç°æ€§èƒ½ä¸‹é™ã€‚ç„¶è€Œï¼ŒBNå±‚æ˜¯éçº¿æ€§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬å°†ç‰¹å¾å›¾é™¤ä»¥å®ƒçš„æ ‡å‡†å·®ï¼Œè¿™é˜»æ­¢äº†åœ¨çº¿åˆå¹¶å—ã€‚ä¸ºäº†ä½¿åœ¨çº¿é‡å‚åŒ–å¯è¡Œï¼Œä½œè€…å»æ‰äº†é‡å‚å—ä¸­çš„æ‰€æœ‰BNå±‚ï¼Œå¹¶å¼•å…¥äº†BNå±‚çš„çº¿æ€§æ›¿ä»£æ–¹æ³•ï¼Œå³çº¿æ€§ç¼©æ”¾å±‚ã€‚

#### å·ç§¯åˆ†è§£
æ ‡å‡†å·ç§¯å±‚è®¡ç®—æ¯”è¾ƒå¯†é›†ï¼Œå¯¼è‡´å¤§çš„FLOPså’Œå‚æ•°é‡ã€‚å› æ­¤ï¼Œå·ç§¯åˆ†è§£æ–¹æ³•è¢«æå‡ºï¼Œå¹¶å¹¿æ³›åº”ç”¨äºç§»åŠ¨è®¾å¤‡çš„è½»é‡åŒ–æ¨¡å‹ä¸­ã€‚é‡å‚åŒ–æ–¹æ³•ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å·ç§¯åˆ†è§£çš„æŸç§å½¢å¼ï¼Œä½†å®ƒæ›´å€¾å‘äºæ›´å¤æ‚çš„æ‹“æ‰‘ç»“æ„ã€‚æœ¬æ–‡çš„æ–¹æ³•çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œåœ¨kernel-levelä¸Šåˆ†è§£å·ç§¯ï¼Œè€Œä¸æ˜¯åœ¨structure levelã€‚

#### åœ¨çº¿é‡å‚åŒ–
åœ¨æœ¬èŠ‚ä¸­ï¼Œé¦–å…ˆï¼Œåˆ†æäº†å…³é”®ç»„ä»¶ï¼Œå³é‡å‚åŒ–æ¨¡å‹ä¸­çš„BNå±‚ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæå‡ºäº†åœ¨çº¿é‡å‚åŒ–(OREPA)ï¼Œæ—¨åœ¨å¤§å¤§å‡å°‘å†å‚æ•°åŒ–æ¨¡å‹çš„è®­ç»ƒæ—¶é—´é¢„ç®—ã€‚OREPAèƒ½å¤Ÿå°†å¤æ‚çš„è®­ç»ƒæ—¶é—´å—ç®€åŒ–ä¸ºä¸€ä¸ªå·ç§¯å±‚ï¼Œå¹¶ä¿æŒäº†è¾ƒé«˜çš„ç²¾åº¦ã€‚

OREPAçš„æ•´ä½“pipelineå¦‚å›¾æ‰€ç¤ºï¼Œå®ƒåŒ…æ‹¬ä¸€ä¸ªBlock Linearizationé˜¶æ®µå’Œä¸€ä¸ªBlock Squeezingé˜¶æ®µã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/7b39a390dd264540b91062d7d237bfc7.png)
å‚è€ƒè¯¥åšå®¢é€šè¿‡åˆ†æå¤šå±‚å’Œå¤šåˆ†æ”¯ç»“æ„çš„ä¼˜åŒ–å¤šæ ·æ€§ï¼Œæ·±å…¥ç ”ç©¶äº†é‡å‚åŒ–çš„æœ‰æ•ˆæ€§ï¼Œå¹¶è¯æ˜äº†æ‰€æå‡ºçš„çº¿æ€§ç¼©æ”¾å±‚å’ŒBNå±‚å…·æœ‰ç›¸ä¼¼çš„æ•ˆæœã€‚

æœ€åï¼Œéšç€è®­ç»ƒé¢„ç®—çš„å‡å°‘ï¼Œè¿›ä¸€æ­¥æ¢ç´¢äº†æ›´å¤šçš„ç»„ä»¶ï¼Œä»¥å®ç°æ›´å¼ºçš„é‡å‚åŒ–æ¨¡å‹ï¼Œæˆæœ¬ç•¥æœ‰å¢åŠ ã€‚

#### é‡å‚åŒ–ä¸­çš„Normalization
ä½œè€…è®¤ä¸ºä¸­é—´BNå±‚æ˜¯é‡å‚åŒ–è¿‡ç¨‹ä¸­å¤šå±‚å’Œå¤šåˆ†æ”¯ç»“æ„çš„å…³é”®ç»„æˆéƒ¨åˆ†ã€‚ä»¥SoTAæ¨¡å‹DBBå’ŒRepVGGä¸ºä¾‹ï¼Œå»é™¤è¿™äº›å±‚ä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½ä¸‹é™ï¼Œå¦‚è¡¨1æ‰€ç¤ºã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/e3da47c1a49846b59a11f8c379d0ba68.png)

è¿™ç§è§‚å¯Ÿç»“æœä¹Ÿå¾—åˆ°äº†Dingç­‰äººçš„å®éªŒæ”¯æŒã€‚å› æ­¤ï¼Œä½œè€…è®¤ä¸ºä¸­é—´çš„BNå±‚å¯¹äºé‡å‚åŒ–æ¨¡å‹çš„æ€§èƒ½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚

ç„¶è€Œï¼Œä¸­é—´BNå±‚çš„ä½¿ç”¨å¸¦æ¥äº†æ›´é«˜çš„è®­ç»ƒé¢„ç®—ã€‚ä½œè€…æ³¨æ„åˆ°ï¼Œåœ¨æ¨ç†é˜¶æ®µï¼Œé‡å‚åŒ–å—ä¸­çš„æ‰€æœ‰ä¸­é—´æ“ä½œéƒ½æ˜¯çº¿æ€§çš„ï¼Œå› æ­¤å¯ä»¥åˆå¹¶æˆä¸€ä¸ªå·ç§¯å±‚ï¼Œä»è€Œå½¢æˆä¸€ä¸ªç®€å•çš„ç»“æ„ã€‚

ä½†åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒBNå±‚æ˜¯éçº¿æ€§çš„ï¼Œå³å®ƒä»¬å°†ç‰¹å¾æ˜ å°„é™¤ä»¥å…¶æ ‡å‡†å·®ã€‚å› æ­¤ï¼Œä¸­é—´æ“ä½œåº”è¯¥å•ç‹¬è®¡ç®—ï¼Œè¿™å°†å¯¼è‡´æ›´é«˜çš„è®¡ç®—å’Œå†…å­˜æˆæœ¬ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æ­¤é«˜çš„æˆæœ¬å°†é˜»æ­¢æ¢ç´¢æ›´å¼ºå¤§çš„è®­ç»ƒæ¨¡å—ã€‚

#### Block Linearization
å¦‚3.1ä¸­æ‰€è¿°ï¼Œä¸­é—´çš„BNå±‚é˜»æ­¢äº†åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åˆå¹¶å•ç‹¬çš„å±‚ã€‚ç„¶è€Œï¼Œç”±äºæ€§èƒ½é—®é¢˜ï¼Œç›´æ¥åˆ é™¤å®ƒä»¬å¹¶ä¸ç®€å•ã€‚ä¸ºäº†è§£å†³è¿™ä¸€å›°å¢ƒï¼Œä½œè€…å¼•å…¥äº†channelçº§çº¿æ€§å°ºåº¦æ“ä½œä½œä¸ºBNçš„çº¿æ€§æ›¿ä»£æ–¹æ³•ã€‚

ç¼©æ”¾å±‚åŒ…å«ä¸€ä¸ªå¯å­¦ä¹ çš„å‘é‡ï¼Œå®ƒåœ¨é€šé“ç»´åº¦ä¸­ç¼©æ”¾ç‰¹å¾æ˜ å°„ã€‚çº¿æ€§ç¼©æ”¾å±‚å…·æœ‰ä¸BNå±‚ç›¸ä¼¼çš„æ•ˆæœï¼Œå®ƒä»¬éƒ½ä¿ƒè¿›å¤šåˆ†æ”¯å‘ä¸åŒçš„æ–¹å‘è¿›è¡Œä¼˜åŒ–ï¼Œè¿™æ˜¯é‡å‚åŒ–æ—¶æ€§èƒ½æé«˜çš„å…³é”®ã€‚é™¤äº†å¯¹æ€§èƒ½çš„å½±å“å¤–ï¼Œçº¿æ€§ç¼©æ”¾å±‚è¿˜å¯ä»¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¿›è¡Œåˆå¹¶ï¼Œä½¿åœ¨çº¿é‡å‚åŒ–æˆä¸ºå¯èƒ½ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/42f5755f8681476e9a4896871597a2dd.png)

åŸºäºçº¿æ€§ç¼©æ”¾å±‚ï¼Œä½œè€…ä¿®æ”¹äº†é‡å‚åŒ–å—ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚å…·ä½“æ¥è¯´ï¼Œå—çš„çº¿æ€§åŒ–é˜¶æ®µç”±ä»¥ä¸‹3ä¸ªæ­¥éª¤ç»„æˆï¼š

é¦–å…ˆï¼Œåˆ é™¤äº†æ‰€æœ‰çš„éçº¿æ€§å±‚ï¼Œå³é‡å‚åŒ–å—ä¸­çš„BNå±‚

å…¶æ¬¡ï¼Œä¸ºäº†ä¿æŒä¼˜åŒ–çš„å¤šæ ·æ€§ï¼Œåœ¨æ¯ä¸ªåˆ†æ”¯çš„æœ«å°¾æ·»åŠ äº†ä¸€ä¸ªç¼©æ”¾å±‚ï¼Œè¿™æ˜¯BNçš„çº¿æ€§æ›¿ä»£æ–¹æ³•

æœ€åï¼Œä¸ºäº†ç¨³å®šè®­ç»ƒè¿‡ç¨‹ï¼Œåœ¨æ‰€æœ‰åˆ†æ”¯çš„æ·»åŠ åæ·»åŠ ä¸€ä¸ªBNå±‚ã€‚

ä¸€æ—¦å®Œæˆçº¿æ€§åŒ–é˜¶æ®µï¼Œåœ¨é‡å‚åŒ–å—ä¸­åªå­˜åœ¨çº¿æ€§å±‚ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨è®­ç»ƒé˜¶æ®µåˆå¹¶å—ä¸­çš„æ‰€æœ‰ç»„ä»¶ã€‚

#### Block Squeezing
Block Squeezingæ­¥éª¤å°†è®¡ç®—å’Œå†…å­˜æ˜‚è´µçš„ä¸­é—´ç‰¹å¾æ˜ å°„ä¸Šçš„æ“ä½œè½¬æ¢ä¸ºæ›´ç»æµçš„kernelä¸Šçš„æ“ä½œã€‚è¿™æ„å‘³ç€åœ¨è®¡ç®—å’Œå†…å­˜æ–¹é¢ä»å‡å°‘åˆ°ï¼Œå…¶ä¸­ã€æ˜¯ç‰¹å¾å›¾å’Œå·ç§¯æ ¸çš„ç©ºé—´å°ºå¯¸ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œæ— è®ºçº¿æ€§é‡å‚åŒ–å—æ˜¯å¤šä¹ˆå¤æ‚ï¼Œä»¥ä¸‹2ä¸ªå±æ€§å§‹ç»ˆæˆç«‹ï¼š

Blockä¸­çš„æ‰€æœ‰çº¿æ€§å±‚ï¼Œä¾‹å¦‚æ·±åº¦å·ç§¯ã€å¹³å‡æ± åŒ–å’Œæ‰€æå‡ºçš„çº¿æ€§ç¼©æ”¾ï¼Œéƒ½å¯ä»¥ç”¨å¸¦æœ‰ç›¸åº”å‚æ•°çš„é€€åŒ–å·ç§¯å±‚æ¥è¡¨ç¤º;

Blockå¯ä»¥ç”±ä¸€ç³»åˆ—å¹¶è¡Œåˆ†æ”¯è¡¨ç¤ºï¼Œæ¯ä¸ªåˆ†æ”¯ç”±ä¸€ç³»åˆ—å·ç§¯å±‚ç»„æˆã€‚

æœ‰äº†ä¸Šè¿°ä¸¤ä¸ªç‰¹æ€§ï¼Œå¦‚æœå¯ä»¥å°†

å¤šå±‚ï¼ˆå³é¡ºåºç»“æ„ï¼‰

å¤šåˆ†æ”¯ï¼ˆå³å¹¶è¡Œç»“æ„ï¼‰

ç®€åŒ–ä¸ºå•ä¸€å·ç§¯ï¼Œå°±å¯ä»¥å‹ç¼©ä¸€ä¸ªå—ã€‚åœ¨ä¸‹é¢çš„éƒ¨åˆ†ä¸­ï¼Œå°†å±•ç¤ºå¦‚ä½•ç®€åŒ–é¡ºåºç»“æ„(å›¾(a))å’Œå¹¶è¡Œç»“æ„(å›¾(b))ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/direct/c386ba0296fc46e9b235c7ff1d64f26b.png)


### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤º

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10. YOLOv11æ ¸å¿ƒæ”¹è¿›æºç è®²è§£

#### 10.1 predict.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç²¾ç®€å’Œæ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license

from ultralytics.engine.predictor import BasePredictor
from ultralytics.engine.results import Results
from ultralytics.utils import ops

class DetectionPredictor(BasePredictor):
    """
    DetectionPredictorç±»ï¼Œç»§æ‰¿è‡ªBasePredictorç±»ï¼Œç”¨äºåŸºäºæ£€æµ‹æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚
    """

    def postprocess(self, preds, img, orig_imgs):
        """
        å¯¹é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œå¹¶è¿”å›Resultså¯¹è±¡çš„åˆ—è¡¨ã€‚

        å‚æ•°:
        preds: æ¨¡å‹çš„é¢„æµ‹ç»“æœ
        img: è¾“å…¥å›¾åƒ
        orig_imgs: åŸå§‹å›¾åƒåˆ—è¡¨

        è¿”å›:
        results: åŒ…å«å¤„ç†åç»“æœçš„Resultså¯¹è±¡åˆ—è¡¨
        """
        # åº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰æ¥è¿‡æ»¤é¢„æµ‹æ¡†
        preds = ops.non_max_suppression(
            preds,
            self.args.conf,  # ç½®ä¿¡åº¦é˜ˆå€¼
            self.args.iou,   # IOUé˜ˆå€¼
            agnostic=self.args.agnostic_nms,  # æ˜¯å¦ä½¿ç”¨ç±»åˆ«æ— å…³çš„NMS
            max_det=self.args.max_det,  # æœ€å¤§æ£€æµ‹æ¡†æ•°é‡
            classes=self.args.classes,   # è¿‡æ»¤ç‰¹å®šç±»åˆ«
        )

        # å¦‚æœè¾“å…¥çš„åŸå§‹å›¾åƒä¸æ˜¯åˆ—è¡¨ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºnumpyæ•°ç»„
        if not isinstance(orig_imgs, list):
            orig_imgs = ops.convert_torch2numpy_batch(orig_imgs)

        results = []  # åˆå§‹åŒ–ç»“æœåˆ—è¡¨
        for i, pred in enumerate(preds):
            orig_img = orig_imgs[i]  # è·å–å¯¹åº”çš„åŸå§‹å›¾åƒ
            # å°†é¢„æµ‹æ¡†çš„åæ ‡ç¼©æ”¾åˆ°åŸå§‹å›¾åƒçš„å°ºå¯¸
            pred[:, :4] = ops.scale_boxes(img.shape[2:], pred[:, :4], orig_img.shape)
            img_path = self.batch[0][i]  # è·å–å›¾åƒè·¯å¾„
            # åˆ›å»ºResultså¯¹è±¡å¹¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨
            results.append(Results(orig_img, path=img_path, names=self.model.names, boxes=pred))
        
        return results  # è¿”å›å¤„ç†åçš„ç»“æœåˆ—è¡¨
```

### ä»£ç åˆ†æï¼š
1. **ç±»å®šä¹‰**ï¼š`DetectionPredictor`ç±»ç»§æ‰¿è‡ª`BasePredictor`ï¼Œç”¨äºå®ç°ç›®æ ‡æ£€æµ‹çš„é¢„æµ‹åŠŸèƒ½ã€‚
2. **åå¤„ç†æ–¹æ³•**ï¼š`postprocess`æ–¹æ³•è´Ÿè´£å¯¹æ¨¡å‹çš„é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œä¸»è¦åŒ…æ‹¬ï¼š
   - åº”ç”¨éæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰æ¥å»é™¤å†—ä½™çš„é¢„æµ‹æ¡†ã€‚
   - å°†é¢„æµ‹æ¡†çš„åæ ‡ç¼©æ”¾åˆ°åŸå§‹å›¾åƒçš„å°ºå¯¸ã€‚
   - å°†å¤„ç†åçš„ç»“æœå°è£…ä¸º`Results`å¯¹è±¡å¹¶è¿”å›ã€‚
3. **å‚æ•°è¯´æ˜**ï¼š
   - `preds`ï¼šæ¨¡å‹çš„é¢„æµ‹ç»“æœï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªé¢„æµ‹æ¡†çš„å¼ é‡ã€‚
   - `img`ï¼šè¾“å…¥çš„å›¾åƒï¼Œç”¨äºè·å–å°ºå¯¸ä¿¡æ¯ã€‚
   - `orig_imgs`ï¼šåŸå§‹å›¾åƒï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå¼ é‡æˆ–åˆ—è¡¨ï¼Œåç»­å¤„ç†æ—¶éœ€è¦å°†å…¶è½¬æ¢ä¸ºnumpyæ•°ç»„ä»¥ä¾¿å¤„ç†ã€‚

è¿™ä¸ªä»£ç çš„æ ¸å¿ƒåœ¨äºå¦‚ä½•å¯¹æ¨¡å‹çš„è¾“å‡ºè¿›è¡Œæœ‰æ•ˆçš„åå¤„ç†ï¼Œä»¥ä¾¿å¾—åˆ°æœ€ç»ˆçš„æ£€æµ‹ç»“æœã€‚

è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºç›®æ ‡æ£€æµ‹çš„é¢„æµ‹å™¨ç±»ï¼Œåä¸º `DetectionPredictor`ï¼Œå®ƒç»§æ‰¿è‡ª `BasePredictor` ç±»ã€‚è¯¥ç±»çš„ä¸»è¦åŠŸèƒ½æ˜¯å¯¹è¾“å…¥çš„å›¾åƒè¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œå¹¶å¯¹æ£€æµ‹ç»“æœè¿›è¡Œåå¤„ç†ã€‚

åœ¨æ–‡ä»¶çš„å¼€å¤´ï¼Œé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `BasePredictor`ã€`Results` å’Œä¸€äº›æ“ä½œå·¥å…· `ops`ã€‚è¿™äº›æ¨¡å—éƒ½æ˜¯æ¥è‡ªäº `ultralytics` åº“ï¼Œåè€…æ˜¯ä¸€ä¸ªæµè¡Œçš„è®¡ç®—æœºè§†è§‰åº“ï¼Œç‰¹åˆ«ç”¨äºå®ç° YOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—çš„ç›®æ ‡æ£€æµ‹æ¨¡å‹ã€‚

`DetectionPredictor` ç±»ä¸­åŒ…å«ä¸€ä¸ªæ–¹æ³• `postprocess`ï¼Œè¯¥æ–¹æ³•è´Ÿè´£å¯¹æ¨¡å‹çš„é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š`preds`ï¼ˆæ¨¡å‹çš„é¢„æµ‹ç»“æœï¼‰ã€`img`ï¼ˆè¾“å…¥å›¾åƒï¼‰å’Œ `orig_imgs`ï¼ˆåŸå§‹å›¾åƒï¼‰ã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œé¦–å…ˆä½¿ç”¨ `ops.non_max_suppression` å‡½æ•°å¯¹é¢„æµ‹ç»“æœè¿›è¡Œéæå¤§å€¼æŠ‘åˆ¶ï¼Œä»¥å»é™¤å†—ä½™çš„æ£€æµ‹æ¡†ã€‚è¿™ä¸€è¿‡ç¨‹ä¾èµ–äºä¸€äº›å‚æ•°ï¼Œå¦‚ç½®ä¿¡åº¦é˜ˆå€¼ã€IOUï¼ˆIntersection Over Unionï¼‰é˜ˆå€¼ã€æ˜¯å¦ä½¿ç”¨ç±»åˆ«æ— å…³çš„éæå¤§å€¼æŠ‘åˆ¶ã€æœ€å¤§æ£€æµ‹æ¡†æ•°é‡ä»¥åŠæŒ‡å®šçš„ç±»åˆ«ã€‚

æ¥ä¸‹æ¥ï¼Œæ–¹æ³•æ£€æŸ¥ `orig_imgs` æ˜¯å¦ä¸ºåˆ—è¡¨ã€‚å¦‚æœä¸æ˜¯ï¼Œè¯´æ˜è¾“å…¥çš„å›¾åƒæ˜¯ä¸€ä¸ª PyTorch å¼ é‡ï¼Œå› æ­¤éœ€è¦å°†å…¶è½¬æ¢ä¸º NumPy æ•°ç»„æ ¼å¼ã€‚ç„¶åï¼Œæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªç©ºçš„ç»“æœåˆ—è¡¨ `results`ï¼Œç”¨äºå­˜å‚¨æ¯ä¸ªå›¾åƒçš„æ£€æµ‹ç»“æœã€‚

åœ¨éšåçš„å¾ªç¯ä¸­ï¼Œæ–¹æ³•éå†æ¯ä¸ªé¢„æµ‹ç»“æœï¼Œå¹¶å°†å…¶ä¸å¯¹åº”çš„åŸå§‹å›¾åƒè¿›è¡Œé…å¯¹ã€‚é€šè¿‡è°ƒç”¨ `ops.scale_boxes` å‡½æ•°ï¼Œå°†é¢„æµ‹æ¡†çš„åæ ‡ä»å½“å‰å›¾åƒçš„å°ºå¯¸ç¼©æ”¾åˆ°åŸå§‹å›¾åƒçš„å°ºå¯¸ã€‚æ¥ç€ï¼Œæ–¹æ³•è·å–å½“å‰å›¾åƒçš„è·¯å¾„ï¼Œå¹¶å°†åŸå§‹å›¾åƒã€è·¯å¾„ã€æ¨¡å‹çš„ç±»åˆ«åç§°ä»¥åŠè°ƒæ•´åçš„é¢„æµ‹æ¡†å°è£…æˆä¸€ä¸ª `Results` å¯¹è±¡ï¼Œæ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­ã€‚

æœ€åï¼Œ`postprocess` æ–¹æ³•è¿”å›åŒ…å«æ‰€æœ‰æ£€æµ‹ç»“æœçš„åˆ—è¡¨ã€‚è¿™ä¸€è¿‡ç¨‹ç¡®ä¿äº†æ¨¡å‹çš„è¾“å‡ºç»è¿‡åˆç†çš„å¤„ç†ï¼Œä¾¿äºåç»­çš„åˆ†æå’Œå¯è§†åŒ–ã€‚æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯å®ç°ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„é¢„æµ‹å’Œç»“æœçš„åå¤„ç†ï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨ã€‚

#### 10.2 fast_kan_conv.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import torch
import torch.nn as nn

class RadialBasisFunction(nn.Module):
    def __init__(self, grid_min: float = -2., grid_max: float = 2., num_grids: int = 8, denominator: float = None):
        super().__init__()
        # åˆ›å»ºä¸€ä¸ªçº¿æ€§ç©ºé—´ï¼ŒèŒƒå›´ä»grid_minåˆ°grid_maxï¼ŒåŒ…å«num_gridsä¸ªç‚¹
        grid = torch.linspace(grid_min, grid_max, num_grids)
        # å°†gridå®šä¹‰ä¸ºæ¨¡å‹å‚æ•°ï¼Œä¸éœ€è¦æ¢¯åº¦æ›´æ–°
        self.grid = torch.nn.Parameter(grid, requires_grad=False)
        # è®¡ç®—åˆ†æ¯ï¼Œå¦‚æœæœªæä¾›ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼
        self.denominator = denominator or (grid_max - grid_min) / (num_grids - 1)

    def forward(self, x):
        # è®¡ç®—å¾„å‘åŸºå‡½æ•°çš„è¾“å‡º
        return torch.exp(-((x[..., None] - self.grid) / self.denominator) ** 2)

class FastKANConvNDLayer(nn.Module):
    def __init__(self, conv_class, norm_class, input_dim, output_dim, kernel_size, groups=1, padding=0, stride=1, dilation=1, ndim: int = 2, grid_size=8, base_activation=nn.SiLU, grid_range=[-2, 2], dropout=0.0):
        super(FastKANConvNDLayer, self).__init__()
        # åˆå§‹åŒ–è¾“å…¥å’Œè¾“å‡ºç»´åº¦ã€å·ç§¯å‚æ•°ç­‰
        self.inputdim = input_dim
        self.outdim = output_dim
        self.kernel_size = kernel_size
        self.padding = padding
        self.stride = stride
        self.dilation = dilation
        self.groups = groups
        self.ndim = ndim
        self.grid_size = grid_size
        self.base_activation = base_activation()
        self.grid_range = grid_range

        # éªŒè¯å‚æ•°çš„æœ‰æ•ˆæ€§
        if groups <= 0:
            raise ValueError('groups must be a positive integer')
        if input_dim % groups != 0:
            raise ValueError('input_dim must be divisible by groups')
        if output_dim % groups != 0:
            raise ValueError('output_dim must be divisible by groups')

        # åˆ›å»ºåŸºç¡€å·ç§¯å±‚å’Œæ ·æ¡å·ç§¯å±‚
        self.base_conv = nn.ModuleList([conv_class(input_dim // groups, output_dim // groups, kernel_size, stride, padding, dilation, groups=1, bias=False) for _ in range(groups)])
        self.spline_conv = nn.ModuleList([conv_class(grid_size * input_dim // groups, output_dim // groups, kernel_size, stride, padding, dilation, groups=1, bias=False) for _ in range(groups)])
        self.layer_norm = nn.ModuleList([norm_class(output_dim // groups) for _ in range(groups)])

        # åˆå§‹åŒ–å¾„å‘åŸºå‡½æ•°
        self.rbf = RadialBasisFunction(grid_range[0], grid_range[1], grid_size)

        # åˆå§‹åŒ–dropoutå±‚
        self.dropout = None
        if dropout > 0:
            if ndim == 1:
                self.dropout = nn.Dropout1d(p=dropout)
            if ndim == 2:
                self.dropout = nn.Dropout2d(p=dropout)
            if ndim == 3:
                self.dropout = nn.Dropout3d(p=dropout)

        # ä½¿ç”¨Kaimingå‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–å·ç§¯å±‚çš„æƒé‡
        for conv_layer in self.base_conv:
            nn.init.kaiming_uniform_(conv_layer.weight, nonlinearity='linear')
        for conv_layer in self.spline_conv:
            nn.init.kaiming_uniform_(conv_layer.weight, nonlinearity='linear')

    def forward_fast_kan(self, x, group_index):
        # å¯¹è¾“å…¥åº”ç”¨åŸºç¡€æ¿€æ´»å‡½æ•°ï¼Œå¹¶è¿›è¡Œçº¿æ€§å˜æ¢
        base_output = self.base_conv[group_index](self.base_activation(x))
        if self.dropout is not None:
            x = self.dropout(x)
        # è®¡ç®—æ ·æ¡åŸºå‡½æ•°
        spline_basis = self.rbf(self.layer_norm[group_index](x))
        spline_basis = spline_basis.moveaxis(-1, 2).flatten(1, 2)
        # è¿›è¡Œæ ·æ¡å·ç§¯
        spline_output = self.spline_conv[group_index](spline_basis)
        # è¿”å›åŸºç¡€è¾“å‡ºå’Œæ ·æ¡è¾“å‡ºçš„å’Œ
        x = base_output + spline_output
        return x

    def forward(self, x):
        # å°†è¾“å…¥åˆ†å‰²ä¸ºå¤šä¸ªç»„
        split_x = torch.split(x, self.inputdim // self.groups, dim=1)
        output = []
        for group_ind, _x in enumerate(split_x):
            # å¯¹æ¯ä¸ªç»„åº”ç”¨fast kanå·ç§¯
            y = self.forward_fast_kan(_x.clone(), group_ind)
            output.append(y.clone())
        # å°†æ‰€æœ‰ç»„çš„è¾“å‡ºæ‹¼æ¥åœ¨ä¸€èµ·
        y = torch.cat(output, dim=1)
        return y
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **RadialBasisFunction**ï¼šå®ç°äº†ä¸€ä¸ªå¾„å‘åŸºå‡½æ•°ï¼Œç”¨äºè®¡ç®—è¾“å…¥ä¸é¢„å®šä¹‰ç½‘æ ¼ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚
2. **FastKANConvNDLayer**ï¼šè¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„å·ç§¯å±‚å®ç°ï¼Œæ”¯æŒä»»æ„ç»´åº¦çš„å·ç§¯æ“ä½œã€‚å®ƒä½¿ç”¨åŸºç¡€å·ç§¯å’Œæ ·æ¡å·ç§¯ç›¸ç»“åˆçš„æ–¹å¼æ¥å¢å¼ºç‰¹å¾æå–èƒ½åŠ›ã€‚
3. **forward_fast_kan**ï¼šå®ç°äº†å¯¹è¾“å…¥çš„å‰å‘ä¼ æ’­ï¼ŒåŒ…æ‹¬åŸºç¡€å·ç§¯å’Œæ ·æ¡å·ç§¯çš„è®¡ç®—ã€‚
4. **forward**ï¼šå®ç°äº†å¯¹è¾“å…¥çš„åˆ†ç»„å¤„ç†å’Œæœ€ç»ˆè¾“å‡ºçš„æ‹¼æ¥ã€‚

é€šè¿‡è¿™äº›æ ¸å¿ƒéƒ¨åˆ†ï¼Œæ¨¡å‹èƒ½å¤Ÿæœ‰æ•ˆåœ°è¿›è¡Œå·ç§¯æ“ä½œï¼Œå¹¶é€šè¿‡å¾„å‘åŸºå‡½æ•°å¢å¼ºç‰¹å¾æå–çš„èƒ½åŠ›ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `fast_kan_conv.py` å®ç°äº†ä¸€ä¸ªåŸºäºå¿«é€Ÿå¾„å‘åŸºå‡½æ•°ï¼ˆRadial Basis Function, RBFï¼‰å·ç§¯çš„ç¥ç»ç½‘ç»œå±‚ï¼Œä¸»è¦ç”¨äºå¤„ç†å¤šç»´æ•°æ®çš„å·ç§¯æ“ä½œã€‚ç¨‹åºä¸­å®šä¹‰äº†å‡ ä¸ªç±»ï¼Œå…¶ä¸­æœ€é‡è¦çš„ç±»æ˜¯ `FastKANConvNDLayer`ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€šç”¨çš„å¤šç»´å·ç§¯å±‚ï¼Œèƒ½å¤Ÿæ ¹æ®è¾“å…¥çš„ç»´åº¦ï¼ˆ1Dã€2Dã€3Dï¼‰è¿›è¡Œç›¸åº”çš„å·ç§¯æ“ä½œã€‚

é¦–å…ˆï¼Œ`RadialBasisFunction` ç±»å®šä¹‰äº†ä¸€ä¸ªå¾„å‘åŸºå‡½æ•°ï¼Œå…¶æ„é€ å‡½æ•°æ¥å—ç½‘æ ¼çš„æœ€å°å€¼ã€æœ€å¤§å€¼ã€ç½‘æ ¼æ•°é‡å’Œåˆ†æ¯å‚æ•°ã€‚é€šè¿‡ `torch.linspace` ç”Ÿæˆä¸€ä¸ªå‡åŒ€åˆ†å¸ƒçš„ç½‘æ ¼ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºä¸å¯è®­ç»ƒçš„å‚æ•°ã€‚`forward` æ–¹æ³•è®¡ç®—è¾“å…¥ `x` ä¸ç½‘æ ¼ä¹‹é—´çš„è·ç¦»ï¼Œå¹¶é€šè¿‡é«˜æ–¯å‡½æ•°è¿›è¡Œè½¬æ¢ï¼Œè¾“å‡ºä¸€ä¸ªåŸºäºå¾„å‘åŸºå‡½æ•°çš„ç»“æœã€‚

æ¥ä¸‹æ¥ï¼Œ`FastKANConvNDLayer` ç±»æ˜¯æ ¸å¿ƒå·ç§¯å±‚çš„å®ç°ã€‚å®ƒçš„æ„é€ å‡½æ•°æ¥å—å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬è¾“å…¥å’Œè¾“å‡ºç»´åº¦ã€å·ç§¯æ ¸å¤§å°ã€åˆ†ç»„æ•°ã€å¡«å……ã€æ­¥å¹…ã€æ‰©å¼ ã€ç½‘æ ¼å¤§å°ã€åŸºç¡€æ¿€æ´»å‡½æ•°ã€ç½‘æ ¼èŒƒå›´å’Œä¸¢å¼ƒç‡ç­‰ã€‚è¯¥ç±»ä¼šæ£€æŸ¥åˆ†ç»„æ•°å’Œè¾“å…¥è¾“å‡ºç»´åº¦çš„æœ‰æ•ˆæ€§ï¼Œå¹¶åˆå§‹åŒ–åŸºç¡€å·ç§¯å±‚ã€æ ·æ¡å·ç§¯å±‚ã€å±‚å½’ä¸€åŒ–å±‚å’Œå¾„å‘åŸºå‡½æ•°ã€‚åŸºç¡€å·ç§¯å±‚å’Œæ ·æ¡å·ç§¯å±‚åˆ†åˆ«ä½¿ç”¨ `conv_class` åˆ›å»ºï¼Œå½’ä¸€åŒ–å±‚ä½¿ç”¨ `norm_class` åˆ›å»ºã€‚æƒé‡ä½¿ç”¨ Kaiming å‡åŒ€åˆ†å¸ƒè¿›è¡Œåˆå§‹åŒ–ï¼Œä»¥æé«˜è®­ç»ƒçš„èµ·å§‹æ•ˆæœã€‚

`forward_fast_kan` æ–¹æ³•æ˜¯è¯¥ç±»çš„å‰å‘ä¼ æ’­å‡½æ•°ï¼Œé¦–å…ˆå¯¹è¾“å…¥åº”ç”¨åŸºç¡€æ¿€æ´»å‡½æ•°ï¼Œç„¶åè¿›è¡Œçº¿æ€§å˜æ¢ã€‚æ¥ç€ï¼Œå¦‚æœè®¾ç½®äº†ä¸¢å¼ƒç‡ï¼Œåˆ™å¯¹è¾“å…¥åº”ç”¨ä¸¢å¼ƒå±‚ã€‚éšåï¼Œè®¡ç®—æ ·æ¡åŸºå‡½æ•°å¹¶è¿›è¡Œå·ç§¯æ“ä½œï¼Œæœ€åå°†åŸºç¡€å·ç§¯è¾“å‡ºå’Œæ ·æ¡å·ç§¯è¾“å‡ºç›¸åŠ ï¼Œè¿”å›æœ€ç»ˆç»“æœã€‚

`forward` æ–¹æ³•å°†è¾“å…¥æ•°æ®æŒ‰ç»„åˆ†å‰²ï¼Œå¹¶å¯¹æ¯ä¸ªç»„è°ƒç”¨ `forward_fast_kan` è¿›è¡Œå¤„ç†ï¼Œæœ€åå°†æ‰€æœ‰ç»„çš„è¾“å‡ºæ‹¼æ¥åœ¨ä¸€èµ·ã€‚

æ­¤å¤–ï¼Œç¨‹åºè¿˜å®šä¹‰äº†ä¸‰ä¸ªç‰¹å®šç»´åº¦çš„å·ç§¯å±‚ç±»ï¼š`FastKANConv1DLayer`ã€`FastKANConv2DLayer` å’Œ `FastKANConv3DLayer`ï¼Œå®ƒä»¬åˆ†åˆ«ç»§æ‰¿è‡ª `FastKANConvNDLayer`ï¼Œå¹¶åœ¨æ„é€ å‡½æ•°ä¸­æŒ‡å®šäº†ç›¸åº”çš„å·ç§¯å’Œå½’ä¸€åŒ–ç±»ã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªç¨‹åºå®ç°äº†ä¸€ä¸ªçµæ´»ä¸”é«˜æ•ˆçš„å·ç§¯å±‚ï¼Œèƒ½å¤Ÿåœ¨å¤šç»´æ•°æ®ä¸Šåº”ç”¨å¾„å‘åŸºå‡½æ•°å·ç§¯ï¼Œé€‚ç”¨äºå„ç§æ·±åº¦å­¦ä¹ ä»»åŠ¡ã€‚

#### 10.3 kagn_conv.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import torch
import torch.nn as nn
from functools import lru_cache

class KAGNConvNDLayer(nn.Module):
    def __init__(self, conv_class, norm_class, conv_w_fun, input_dim, output_dim, degree, kernel_size,
                 groups=1, padding=0, stride=1, dilation=1, dropout: float = 0.0, ndim: int = 2):
        super(KAGNConvNDLayer, self).__init__()
        
        # åˆå§‹åŒ–å‚æ•°
        self.inputdim = input_dim  # è¾“å…¥ç»´åº¦
        self.outdim = output_dim    # è¾“å‡ºç»´åº¦
        self.degree = degree         # å¤šé¡¹å¼çš„åº¦æ•°
        self.kernel_size = kernel_size  # å·ç§¯æ ¸å¤§å°
        self.padding = padding       # å¡«å……
        self.stride = stride         # æ­¥å¹…
        self.dilation = dilation     # è†¨èƒ€
        self.groups = groups         # åˆ†ç»„å·ç§¯çš„ç»„æ•°
        self.base_activation = nn.SiLU()  # åŸºç¡€æ¿€æ´»å‡½æ•°
        self.conv_w_fun = conv_w_fun  # å·ç§¯æƒé‡å‡½æ•°
        self.ndim = ndim             # æ•°æ®çš„ç»´åº¦ï¼ˆ1D, 2D, 3Dï¼‰
        self.dropout = None          # Dropoutå±‚

        # æ ¹æ®ç»´åº¦é€‰æ‹©åˆé€‚çš„Dropoutå±‚
        if dropout > 0:
            if ndim == 1:
                self.dropout = nn.Dropout1d(p=dropout)
            elif ndim == 2:
                self.dropout = nn.Dropout2d(p=dropout)
            elif ndim == 3:
                self.dropout = nn.Dropout3d(p=dropout)

        # éªŒè¯è¾“å…¥å’Œè¾“å‡ºç»´åº¦çš„æœ‰æ•ˆæ€§
        if groups <= 0:
            raise ValueError('groups must be a positive integer')
        if input_dim % groups != 0:
            raise ValueError('input_dim must be divisible by groups')
        if output_dim % groups != 0:
            raise ValueError('output_dim must be divisible by groups')

        # åˆ›å»ºåŸºç¡€å·ç§¯å±‚å’Œå½’ä¸€åŒ–å±‚
        self.base_conv = nn.ModuleList([conv_class(input_dim // groups,
                                                   output_dim // groups,
                                                   kernel_size,
                                                   stride,
                                                   padding,
                                                   dilation,
                                                   groups=1,
                                                   bias=False) for _ in range(groups)])

        self.layer_norm = nn.ModuleList([norm_class(output_dim // groups) for _ in range(groups)])

        # å¤šé¡¹å¼æƒé‡çš„å½¢çŠ¶
        poly_shape = (groups, output_dim // groups, (input_dim // groups) * (degree + 1)) + tuple(
            kernel_size for _ in range(ndim))

        # åˆå§‹åŒ–å¤šé¡¹å¼æƒé‡å’Œbetaæƒé‡
        self.poly_weights = nn.Parameter(torch.randn(*poly_shape))
        self.beta_weights = nn.Parameter(torch.zeros(degree + 1, dtype=torch.float32))

        # ä½¿ç”¨Kaimingå‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–å·ç§¯å±‚æƒé‡
        for conv_layer in self.base_conv:
            nn.init.kaiming_uniform_(conv_layer.weight, nonlinearity='linear')

        nn.init.kaiming_uniform_(self.poly_weights, nonlinearity='linear')
        nn.init.normal_(
            self.beta_weights,
            mean=0.0,
            std=1.0 / ((kernel_size ** ndim) * self.inputdim * (self.degree + 1.0)),
        )

    def beta(self, n, m):
        # è®¡ç®—betaå€¼ï¼Œç”¨äºLegendreå¤šé¡¹å¼çš„è®¡ç®—
        return (
            ((m + n) * (m - n) * n ** 2) / (m ** 2 / (4.0 * n ** 2 - 1.0))
        ) * self.beta_weights[n]

    @lru_cache(maxsize=128)  # ä½¿ç”¨ç¼“å­˜é¿å…é‡å¤è®¡ç®—Legendreå¤šé¡¹å¼
    def gram_poly(self, x, degree):
        # è®¡ç®—Legendreå¤šé¡¹å¼
        p0 = x.new_ones(x.size())  # p0 = 1

        if degree == 0:
            return p0.unsqueeze(-1)

        p1 = x  # p1 = x
        grams_basis = [p0, p1]

        for i in range(2, degree + 1):
            p2 = x * p1 - self.beta(i - 1, i) * p0  # é€’å½’è®¡ç®—å¤šé¡¹å¼
            grams_basis.append(p2)
            p0, p1 = p1, p2

        return torch.cat(grams_basis, dim=1)  # å°†æ‰€æœ‰å¤šé¡¹å¼è¿æ¥åœ¨ä¸€èµ·

    def forward_kag(self, x, group_index):
        # å‰å‘ä¼ æ’­è¿‡ç¨‹
        basis = self.base_conv[group_index](self.base_activation(x))  # é€šè¿‡åŸºç¡€å·ç§¯å±‚

        # å°†xå½’ä¸€åŒ–åˆ°[-1, 1]èŒƒå›´å†…
        x = torch.tanh(x).contiguous()

        if self.dropout is not None:
            x = self.dropout(x)  # åº”ç”¨Dropout

        grams_basis = self.base_activation(self.gram_poly(x, self.degree))  # è®¡ç®—Gramå¤šé¡¹å¼
        y = self.conv_w_fun(grams_basis, self.poly_weights[group_index],
                            stride=self.stride, dilation=self.dilation,
                            padding=self.padding, groups=1)  # è®¡ç®—å·ç§¯è¾“å‡º

        y = self.base_activation(self.layer_norm[group_index](y + basis))  # å½’ä¸€åŒ–å¹¶æ¿€æ´»

        return y

    def forward(self, x):
        # å‰å‘ä¼ æ’­ï¼Œå¤„ç†å¤šä¸ªç»„
        split_x = torch.split(x, self.inputdim // self.groups, dim=1)  # æŒ‰ç»„åˆ†å‰²è¾“å…¥
        output = []
        for group_ind, _x in enumerate(split_x):
            y = self.forward_kag(_x.clone(), group_ind)  # å¤„ç†æ¯ä¸ªç»„
            output.append(y.clone())
        y = torch.cat(output, dim=1)  # å°†æ‰€æœ‰ç»„çš„è¾“å‡ºè¿æ¥åœ¨ä¸€èµ·
        return y
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **KAGNConvNDLayerç±»**ï¼šè¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„å·ç§¯å±‚ï¼Œæ”¯æŒå¤šç»´å·ç§¯ï¼ˆ1Dã€2Dã€3Dï¼‰ï¼Œå¹¶å®ç°äº†åŸºäºLegendreå¤šé¡¹å¼çš„å·ç§¯æ“ä½œã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼šè®¾ç½®è¾“å…¥è¾“å‡ºç»´åº¦ã€å·ç§¯å‚æ•°ã€æ¿€æ´»å‡½æ•°ç­‰ï¼Œå¹¶åˆå§‹åŒ–å·ç§¯å±‚å’Œå½’ä¸€åŒ–å±‚ã€‚
3. **betaæ–¹æ³•**ï¼šè®¡ç®—ç”¨äºLegendreå¤šé¡¹å¼çš„betaå€¼ã€‚
4. **gram_polyæ–¹æ³•**ï¼šè®¡ç®—Legendreå¤šé¡¹å¼çš„åŸºï¼Œä½¿ç”¨ç¼“å­˜æ¥æé«˜æ•ˆç‡ã€‚
5. **forward_kagæ–¹æ³•**ï¼šå®ç°äº†å‰å‘ä¼ æ’­é€»è¾‘ï¼Œè®¡ç®—å·ç§¯è¾“å‡ºã€‚
6. **forwardæ–¹æ³•**ï¼šå¤„ç†å¤šä¸ªç»„çš„è¾“å…¥ï¼Œè°ƒç”¨`forward_kag`è¿›è¡Œè®¡ç®—å¹¶åˆå¹¶è¾“å‡ºã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `kagn_conv.py` å®šä¹‰äº†ä¸€ç³»åˆ—ç”¨äºå·ç§¯ç¥ç»ç½‘ç»œçš„å±‚ï¼Œä¸»è¦æ˜¯ KAGNï¼ˆKochawongwatçš„è‡ªé€‚åº”å·ç§¯ï¼‰å·ç§¯å±‚ï¼Œæ”¯æŒä¸€ç»´ã€äºŒç»´å’Œä¸‰ç»´å·ç§¯ã€‚æ–‡ä»¶ä¸­åŒ…å«äº†ä¸€ä¸ªåŸºç±» `KAGNConvNDLayer` å’Œä¸‰ä¸ªå­ç±» `KAGNConv1DLayer`ã€`KAGNConv2DLayer` å’Œ `KAGNConv3DLayer`ï¼Œåˆ†åˆ«ç”¨äºå¤„ç†ä¸åŒç»´åº¦çš„è¾“å…¥æ•°æ®ã€‚

åœ¨ `KAGNConvNDLayer` ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œåˆå§‹åŒ–äº†ä¸€äº›å‚æ•°ï¼ŒåŒ…æ‹¬è¾“å…¥å’Œè¾“å‡ºç»´åº¦ã€å·ç§¯æ ¸å¤§å°ã€åˆ†ç»„æ•°ã€å¡«å……ã€æ­¥å¹…ã€æ‰©å¼ ç‡ç­‰ã€‚è¯¥ç±»ä½¿ç”¨äº†ä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼ˆSiLUï¼‰å’Œå¯é€‰çš„ dropout å±‚ï¼Œä»¥å¢å¼ºæ¨¡å‹çš„è¡¨ç°ã€‚å®ƒè¿˜ç¡®ä¿äº†åˆ†ç»„æ•°æ˜¯æ­£æ•´æ•°ï¼Œå¹¶ä¸”è¾“å…¥å’Œè¾“å‡ºç»´åº¦å¯ä»¥è¢«åˆ†ç»„æ•°æ•´é™¤ã€‚

åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œåˆ›å»ºäº†å¤šä¸ªå·ç§¯å±‚å’Œå½’ä¸€åŒ–å±‚ï¼Œè¿™äº›å±‚çš„æ•°é‡ä¸åˆ†ç»„æ•°ç›¸åŒã€‚æ¯ä¸ªå·ç§¯å±‚çš„æƒé‡ä½¿ç”¨ Kaiming å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–ï¼Œä»¥ä¾¿åœ¨è®­ç»ƒå¼€å§‹æ—¶æœ‰æ›´å¥½çš„è¡¨ç°ã€‚è¿˜å®šä¹‰äº†å¤šé¡¹å¼æƒé‡å’Œ beta æƒé‡ï¼Œç”¨äºåç»­çš„å¤šé¡¹å¼è®¡ç®—ã€‚

`beta` æ–¹æ³•è®¡ç®—ä¸ Legendre å¤šé¡¹å¼ç›¸å…³çš„ beta å€¼ï¼Œ`gram_poly` æ–¹æ³•è®¡ç®—ç»™å®šåº¦æ•°çš„ Gram å¤šé¡¹å¼ï¼Œä½¿ç”¨äº†ç¼“å­˜æœºåˆ¶ä»¥é¿å…é‡å¤è®¡ç®—ã€‚`forward_kag` æ–¹æ³•å®ç°äº†å‰å‘ä¼ æ’­è¿‡ç¨‹ï¼Œé¦–å…ˆå¯¹è¾“å…¥åº”ç”¨åŸºæœ¬æ¿€æ´»å‡½æ•°ï¼Œç„¶åè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œæ¥ç€è®¡ç®— Gram å¤šé¡¹å¼ï¼Œå¹¶é€šè¿‡å·ç§¯å‡½æ•°å’Œå¤šé¡¹å¼æƒé‡è¿›è¡Œå¤„ç†ï¼Œæœ€åè¿›è¡Œå½’ä¸€åŒ–å’Œæ¿€æ´»ã€‚

`forward` æ–¹æ³•å°†è¾“å…¥æ•°æ®æŒ‰ç»„åˆ†å‰²ï¼Œå¹¶å¯¹æ¯ä¸ªç»„è°ƒç”¨ `forward_kag` æ–¹æ³•è¿›è¡Œå¤„ç†ï¼Œæœ€åå°†æ‰€æœ‰ç»„çš„è¾“å‡ºæ‹¼æ¥åœ¨ä¸€èµ·ã€‚

ä¸‰ä¸ªå­ç±» `KAGNConv1DLayer`ã€`KAGNConv2DLayer` å’Œ `KAGNConv3DLayer` ç»§æ‰¿è‡ª `KAGNConvNDLayer`ï¼Œåˆ†åˆ«é’ˆå¯¹ä¸€ç»´ã€äºŒç»´å’Œä¸‰ç»´å·ç§¯è¿›è¡Œäº†ç‰¹å®šçš„åˆå§‹åŒ–ï¼Œä¼ å…¥ç›¸åº”çš„å·ç§¯å’Œå½’ä¸€åŒ–ç±»ã€‚è¿™ä½¿å¾—è¿™ä¸ªæ¨¡å—èƒ½å¤Ÿçµæ´»åœ°å¤„ç†ä¸åŒç»´åº¦çš„æ•°æ®ï¼Œé€‚ç”¨äºå¤šç§æ·±åº¦å­¦ä¹ ä»»åŠ¡ã€‚

#### 10.4 rmt.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import torch
import torch.nn as nn
import torch.nn.functional as F

class DWConv2d(nn.Module):
    """
    æ·±åº¦å¯åˆ†ç¦»å·ç§¯å±‚
    """

    def __init__(self, dim, kernel_size, stride, padding):
        super().__init__()
        # ä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼Œgroups=dimè¡¨ç¤ºæ¯ä¸ªè¾“å…¥é€šé“ç‹¬ç«‹å·ç§¯
        self.conv = nn.Conv2d(dim, dim, kernel_size, stride, padding, groups=dim)

    def forward(self, x: torch.Tensor):
        '''
        x: è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º (b, h, w, c)
        '''
        x = x.permute(0, 3, 1, 2)  # è½¬æ¢ä¸º (b, c, h, w)
        x = self.conv(x)  # è¿›è¡Œå·ç§¯æ“ä½œ
        x = x.permute(0, 2, 3, 1)  # è½¬æ¢å› (b, h, w, c)
        return x


class MaSA(nn.Module):
    """
    å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶
    """

    def __init__(self, embed_dim, num_heads, value_factor=1):
        super().__init__()
        self.factor = value_factor
        self.embed_dim = embed_dim
        self.num_heads = num_heads
        self.head_dim = self.embed_dim * self.factor // num_heads
        self.key_dim = self.embed_dim // num_heads
        self.scaling = self.key_dim ** -0.5  # ç¼©æ”¾å› å­
        # å®šä¹‰çº¿æ€§å˜æ¢å±‚
        self.q_proj = nn.Linear(embed_dim, embed_dim, bias=True)
        self.k_proj = nn.Linear(embed_dim, embed_dim, bias=True)
        self.v_proj = nn.Linear(embed_dim, embed_dim * self.factor, bias=True)
        self.out_proj = nn.Linear(embed_dim * self.factor, embed_dim, bias=True)
        self.reset_parameters()

    def reset_parameters(self):
        # åˆå§‹åŒ–æƒé‡
        nn.init.xavier_normal_(self.q_proj.weight, gain=2 ** -2.5)
        nn.init.xavier_normal_(self.k_proj.weight, gain=2 ** -2.5)
        nn.init.xavier_normal_(self.v_proj.weight, gain=2 ** -2.5)
        nn.init.xavier_normal_(self.out_proj.weight)
        nn.init.constant_(self.out_proj.bias, 0.0)

    def forward(self, x: torch.Tensor, rel_pos):
        '''
        x: è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º (b, h, w, c)
        rel_pos: ä½ç½®å…³ç³»çš„æ©ç 
        '''
        bsz, h, w, _ = x.size()  # è·å–è¾“å…¥çš„æ‰¹æ¬¡å¤§å°å’Œé«˜åº¦å®½åº¦

        q = self.q_proj(x)  # è®¡ç®—æŸ¥è¯¢
        k = self.k_proj(x)  # è®¡ç®—é”®
        v = self.v_proj(x)  # è®¡ç®—å€¼

        k *= self.scaling  # åº”ç”¨ç¼©æ”¾å› å­

        # è®¡ç®—æ³¨æ„åŠ›æƒé‡
        qk_mat = (q @ k.transpose(-1, -2)) + rel_pos  # (b, h, w, n) @ (b, h, w, n) -> (b, h, w, h*w)
        qk_mat = torch.softmax(qk_mat, -1)  # åº”ç”¨softmax

        output = torch.matmul(qk_mat, v)  # è®¡ç®—è¾“å‡º
        output = self.out_proj(output)  # æœ€åçº¿æ€§å˜æ¢
        return output


class FeedForwardNetwork(nn.Module):
    """
    å‰é¦ˆç¥ç»ç½‘ç»œ
    """

    def __init__(self, embed_dim, ffn_dim, activation_fn=F.gelu, dropout=0.0):
        super().__init__()
        self.fc1 = nn.Linear(embed_dim, ffn_dim)  # ç¬¬ä¸€å±‚çº¿æ€§å˜æ¢
        self.fc2 = nn.Linear(ffn_dim, embed_dim)  # ç¬¬äºŒå±‚çº¿æ€§å˜æ¢
        self.dropout = nn.Dropout(dropout)  # dropoutå±‚
        self.activation_fn = activation_fn  # æ¿€æ´»å‡½æ•°

    def forward(self, x: torch.Tensor):
        '''
        x: è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º (b, h, w, c)
        '''
        x = self.fc1(x)  # ç¬¬ä¸€å±‚
        x = self.activation_fn(x)  # æ¿€æ´»
        x = self.dropout(x)  # dropout
        x = self.fc2(x)  # ç¬¬äºŒå±‚
        return x


class VisRetNet(nn.Module):
    """
    è§†è§‰å›å½’ç½‘ç»œ
    """

    def __init__(self, in_chans=3, num_classes=1000, embed_dims=[96, 192, 384, 768], depths=[2, 2, 6, 2], num_heads=[3, 6, 12, 24]):
        super().__init__()
        self.patch_embed = PatchEmbed(in_chans=in_chans, embed_dim=embed_dims[0])  # å›¾åƒåˆ†å—åµŒå…¥
        self.layers = nn.ModuleList()  # å­˜å‚¨ç½‘ç»œå±‚
        for i_layer in range(len(depths)):
            layer = BasicLayer(embed_dim=embed_dims[i_layer], depth=depths[i_layer], num_heads=num_heads[i_layer])
            self.layers.append(layer)

    def forward(self, x):
        x = self.patch_embed(x)  # åµŒå…¥å›¾åƒ
        for layer in self.layers:
            x = layer(x)  # é€å±‚å‰å‘ä¼ æ’­
        return x


# åˆ›å»ºæ¨¡å‹çš„å‡½æ•°
def RMT_T():
    model = VisRetNet(
        embed_dims=[64, 128, 256, 512],
        depths=[2, 2, 8, 2],
        num_heads=[4, 4, 8, 16]
    )
    return model

if __name__ == '__main__':
    model = RMT_T()  # åˆ›å»ºæ¨¡å‹
    inputs = torch.randn((1, 3, 640, 640))  # éšæœºè¾“å…¥
    res = model(inputs)  # å‰å‘ä¼ æ’­
    print(res.size())  # è¾“å‡ºç»“æœçš„å½¢çŠ¶
```

### ä»£ç è¯´æ˜ï¼š
1. **DWConv2d**: å®ç°äº†æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼Œç”¨äºå¯¹è¾“å…¥ç‰¹å¾è¿›è¡Œå·ç§¯æ“ä½œã€‚
2. **MaSA**: å®ç°äº†å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œè®¡ç®—è¾“å…¥ç‰¹å¾çš„æ³¨æ„åŠ›æƒé‡å¹¶ç”Ÿæˆè¾“å‡ºã€‚
3. **FeedForwardNetwork**: å®ç°äº†å‰é¦ˆç¥ç»ç½‘ç»œï¼ŒåŒ…å«ä¸¤å±‚çº¿æ€§å˜æ¢å’Œæ¿€æ´»å‡½æ•°ã€‚
4. **VisRetNet**: è§†è§‰å›å½’ç½‘ç»œçš„ä¸»ç»“æ„ï¼ŒåŒ…å«å›¾åƒåˆ†å—åµŒå…¥å’Œå¤šä¸ªåŸºæœ¬å±‚ï¼ˆBasicLayerï¼‰ã€‚
5. **RMT_T**: ç”¨äºåˆ›å»ºä¸€ä¸ªç‰¹å®šé…ç½®çš„è§†è§‰å›å½’ç½‘ç»œæ¨¡å‹ã€‚

ä»¥ä¸Šä»£ç å®ç°äº†ä¸€ä¸ªè§†è§‰å›å½’ç½‘ç»œçš„åŸºæœ¬ç»“æ„ï¼ŒåŒ…å«äº†æ·±åº¦å¯åˆ†ç¦»å·ç§¯ã€å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œå‰é¦ˆç¥ç»ç½‘ç»œç­‰ç»„ä»¶ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶ `rmt.py` å®ç°äº†ä¸€ä¸ªåŸºäºè§†è§‰å˜æ¢å™¨ï¼ˆVision Transformerï¼‰çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œåä¸º VisRetNetã€‚è¯¥æ¨¡å‹ä¸»è¦ç”¨äºå›¾åƒå¤„ç†ä»»åŠ¡ï¼Œç‰¹åˆ«æ˜¯åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸã€‚ä»¥ä¸‹æ˜¯å¯¹ä»£ç çš„è¯¦ç»†è¯´æ˜ã€‚

é¦–å…ˆï¼Œç¨‹åºå¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬ PyTorch å’Œä¸€äº›ç‰¹å®šçš„æ¨¡å—ã€‚PyTorch æ˜¯ä¸€ä¸ªæµè¡Œçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæä¾›äº†æ„å»ºå’Œè®­ç»ƒç¥ç»ç½‘ç»œçš„å·¥å…·ã€‚æ¥ç€ï¼Œå®šä¹‰äº†ä¸€äº›åŸºç¡€ç»„ä»¶ï¼Œä¾‹å¦‚æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼ˆ`DWConv2d`ï¼‰ã€ç›¸å¯¹ä½ç½®ç¼–ç ï¼ˆ`RelPos2d`ï¼‰ã€å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆ`MaSAd` å’Œ `MaSA`ï¼‰ç­‰ã€‚è¿™äº›ç»„ä»¶æ˜¯æ„å»ºæ›´å¤æ‚æ¨¡å‹çš„åŸºç¡€ã€‚

`DWConv2d` ç±»å®ç°äº†æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼Œå…è®¸å¯¹è¾“å…¥çš„æ¯ä¸ªé€šé“è¿›è¡Œç‹¬ç«‹å·ç§¯æ“ä½œã€‚`RelPos2d` ç±»ç”¨äºç”ŸæˆäºŒç»´çš„ç›¸å¯¹ä½ç½®ç¼–ç ï¼Œè¿™åœ¨å¤„ç†å›¾åƒæ—¶éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥å¸®åŠ©æ¨¡å‹ç†è§£åƒç´ ä¹‹é—´çš„ç›¸å¯¹ä½ç½®å…³ç³»ã€‚`MaSAd` å’Œ `MaSA` ç±»åˆ™å®ç°äº†å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œæ”¯æŒä¸åŒçš„æ³¨æ„åŠ›è®¡ç®—æ–¹å¼ã€‚

æ¥ä¸‹æ¥ï¼Œå®šä¹‰äº† `FeedForwardNetwork` ç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‰é¦ˆç¥ç»ç½‘ç»œï¼Œé€šå¸¸ç”¨äº Transformer æ¨¡å‹ä¸­çš„æ¯ä¸ªå±‚ã€‚`RetBlock` ç±»åˆ™æ˜¯ä¸€ä¸ªæ®‹å·®å—ï¼Œç»“åˆäº†è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œå‰é¦ˆç½‘ç»œï¼Œå¹¶æ”¯æŒå±‚å½’ä¸€åŒ–å’Œå¯é€‰çš„å±‚ç¼©æ”¾ã€‚

`PatchMerging` ç±»å®ç°äº†å›¾åƒçš„ä¸‹é‡‡æ ·ï¼Œé€šè¿‡åˆå¹¶å¤šä¸ªå°å—æ¥å‡å°‘ç‰¹å¾å›¾çš„å°ºå¯¸ã€‚`BasicLayer` ç±»åˆ™è¡¨ç¤ºä¸€ä¸ªåŸºæœ¬çš„ Transformer å±‚ï¼ŒåŒ…å«å¤šä¸ªæ®‹å·®å—ï¼Œå¹¶æ”¯æŒç›¸å¯¹ä½ç½®ç¼–ç ã€‚

`LayerNorm2d` ç±»å®ç°äº†äºŒç»´çš„å±‚å½’ä¸€åŒ–ï¼Œé€‚ç”¨äºå›¾åƒæ•°æ®ã€‚`PatchEmbed` ç±»å°†è¾“å…¥å›¾åƒåˆ’åˆ†ä¸ºå°å—ï¼Œå¹¶å°†è¿™äº›å°å—åµŒå…¥åˆ°ä¸€ä¸ªé«˜ç»´ç©ºé—´ä¸­ï¼Œä½œä¸ºåç»­å±‚çš„è¾“å…¥ã€‚

`VisRetNet` ç±»æ˜¯æ•´ä¸ªæ¨¡å‹çš„æ ¸å¿ƒï¼Œæ„é€ äº†å¤šä¸ªåŸºæœ¬å±‚ï¼Œå¹¶åœ¨æ¯ä¸ªå±‚ä¹‹é—´è¿›è¡Œç‰¹å¾æå–å’Œä¸‹é‡‡æ ·ã€‚å®ƒè¿˜å®šä¹‰äº†æ¨¡å‹çš„åˆå§‹åŒ–æƒé‡çš„æ–¹æ³•ã€‚

æœ€åï¼Œæ–‡ä»¶ä¸­å®šä¹‰äº†å‡ ä¸ªå‡½æ•°ï¼ˆ`RMT_T`ã€`RMT_S`ã€`RMT_B`ã€`RMT_L`ï¼‰ï¼Œç”¨äºåˆ›å»ºä¸åŒè§„æ¨¡çš„ VisRetNet æ¨¡å‹ã€‚è¿™äº›å‡½æ•°æ ¹æ®ä¸åŒçš„å‚æ•°é…ç½®ï¼ˆå¦‚åµŒå…¥ç»´åº¦ã€å±‚æ•°ã€å¤´æ•°ç­‰ï¼‰è¿”å›ç›¸åº”çš„æ¨¡å‹å®ä¾‹ã€‚

åœ¨ `__main__` éƒ¨åˆ†ï¼Œç¨‹åºåˆ›å»ºäº†ä¸€ä¸ªå°å‹çš„ VisRetNet æ¨¡å‹ï¼Œå¹¶å¯¹ä¸€ä¸ªéšæœºç”Ÿæˆçš„è¾“å…¥è¿›è¡Œå‰å‘ä¼ æ’­ï¼Œè¾“å‡ºæ¯ä¸ªç‰¹å¾å›¾çš„å°ºå¯¸ã€‚è¿™ä¸€éƒ¨åˆ†ä¸»è¦ç”¨äºæµ‹è¯•æ¨¡å‹çš„æ„å»ºæ˜¯å¦æ­£ç¡®ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¿™ä¸ªç¨‹åºæ–‡ä»¶å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ PyTorch æ„å»ºä¸€ä¸ªå¤æ‚çš„è§†è§‰å˜æ¢å™¨æ¨¡å‹ï¼Œæ¶µç›–äº†ä»åŸºç¡€ç»„ä»¶åˆ°å®Œæ•´æ¨¡å‹çš„å®ç°ï¼Œé€‚åˆç”¨äºå›¾åƒåˆ†ç±»ç­‰ä»»åŠ¡ã€‚

### 11.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+200+ç§å…¨å¥—åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)


# [ä¸‹è½½é“¾æ¥ï¼šhttps://mbd.pub/o/bread/Z52Tkppr](https://mbd.pub/o/bread/Z52Tkppr)